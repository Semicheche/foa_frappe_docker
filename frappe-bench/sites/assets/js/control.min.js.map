{"version":3,"file":"control.min.js","sources":["../../../apps/frappe/frappe/public/js/frappe/ui/capture.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/base_control.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/base_input.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/data.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/int.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/float.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/currency.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/date.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/time.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/datetime.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/date_range.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/select.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/link.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/dynamic_link.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/text.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/code.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/text_editor.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/check.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/image.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/attach.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/attach_image.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/table.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/color.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/signature.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/password.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/read_only.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/button.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/html.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/heading.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/autocomplete.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/barcode.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/geolocation.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/multiselect.js","../../../apps/frappe/frappe/public/js/frappe/form/controls/multicheck.js"],"sourcesContent":["// frappe.ui.Capture\n// Author - Achilles Rasquinha <achilles@frappe.io>\n\n/**\n * @description Converts a canvas, image or a video to a data URL string.\n * \n * @param \t{HTMLElement} element - canvas, img or video.\n * @returns {string} \t\t\t  - The data URL string.\n * \n * @example\n * frappe._.get_data_uri(video)\n * // returns \"data:image/pngbase64,...\"\n */\nfrappe._.get_data_uri = element =>\n{\n\tconst $element = $(element)\n\tconst width    = $element.width()\n\tconst height   = $element.height()\n\n\tconst $canvas     = $('<canvas/>')\n\t$canvas[0].width  = width\n\t$canvas[0].height = height\n\n\tconst context     = $canvas[0].getContext('2d')\n\tcontext.drawImage($element[0], 0, 0, width, height)\n\t\n\tconst data_uri = $canvas[0].toDataURL('image/png')\n\n\treturn data_uri\n}\n\n/**\n * @description Frappe's Capture object.\n * \n * @example\n * const capture = frappe.ui.Capture()\n * capture.show()\n * \n * capture.click((data_uri) => {\n * \t// do stuff\n * })\n * \n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Taking_still_photos\n */\nfrappe.ui.Capture = class\n{\n\tconstructor (options = { })\n\t{\n\t\tthis.options = frappe.ui.Capture.OPTIONS\n\t\tthis.set_options(options)\n\t}\n\t\n\tset_options (options)\n\t{\n\t\tthis.options = { ...frappe.ui.Capture.OPTIONS, ...options }\n\t\t\n\t\treturn this\n\t}\n\t\n\trender ( )\n\t{\n\t\treturn navigator.mediaDevices.getUserMedia({ video: true }).then(stream =>\n\t\t{\n\t\t\tthis.dialog \t = new frappe.ui.Dialog({\n\t\t\t\t  title: this.options.title,\n\t\t\t\tanimate: this.options.animate,\n\t\t\t\t action:\n\t\t\t\t{\n\t\t\t\t\tsecondary:\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"<b>&times</b>\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\n\t\t\tconst $e \t\t = $(frappe.ui.Capture.TEMPLATE)\n\t\t\t\n\t\t\tconst video      = $e.find('video')[0]\n\t\t\tvideo.srcObject  = stream\n\t\t\tvideo.play()\n\t\t\t\n\t\t\tconst $container = $(this.dialog.body)\n\t\t\t$container.html($e)\n\t\t\t\n\t\t\t$e.find('.fc-btf').hide()\n\n\t\t\t$e.find('.fc-bcp').click(() =>\n\t\t\t{\n\t\t\t\tconst data_url = frappe._.get_data_uri(video)\n\t\t\t\t$e.find('.fc-p').attr('src', data_url)\n\n\t\t\t\t$e.find('.fc-s').hide()\n\t\t\t\t$e.find('.fc-p').show()\n\n\t\t\t\t$e.find('.fc-btu').hide()\n\t\t\t\t$e.find('.fc-btf').show()\n\t\t\t})\n\n\t\t\t$e.find('.fc-br').click(() =>\n\t\t\t{\n\t\t\t\t$e.find('.fc-p').hide()\n\t\t\t\t$e.find('.fc-s').show()\n\n\t\t\t\t$e.find('.fc-btf').hide()\n\t\t\t\t$e.find('.fc-btu').show()\n\t\t\t})\n\n\t\t\t$e.find('.fc-bs').click(() =>\n\t\t\t{\n\t\t\t\tconst data_url = frappe._.get_data_uri(video)\n\t\t\t\tthis.hide()\n\t\t\t\t\n\t\t\t\tif (this.callback)\n\t\t\t\t\tthis.callback(data_url)\n\t\t\t})\n\t\t})\n\t}\n\n\tshow ( )\n\t{\n\t\tthis.render().then(() =>\n\t\t{\n\t\t\tthis.dialog.show()\n\t\t}).catch(err => {\n\t\t\tif ( this.options.error )\n\t\t\t{\n\t\t\t\tconst alert = `<span class=\"indicator red\"/> ${frappe.ui.Capture.ERR_MESSAGE}`\n\t\t\t\tfrappe.show_alert(alert, 3)\n\t\t\t}\n\n\t\t\tthrow err\n\t\t})\n\t}\n\n\thide ( )\n\t{\n\t\tif ( this.dialog )\n\t\t\tthis.dialog.hide()\n\t}\n\n\tsubmit (fn)\n\t{\n\t\tthis.callback = fn\n\t}\n}\nfrappe.ui.Capture.OPTIONS =\n{\n\t  title: __(`Camera`),\n\tanimate: false,\n\t  error: false,\n}\nfrappe.ui.Capture.ERR_MESSAGE = __(\"Unable to load camera.\")\nfrappe.ui.Capture.TEMPLATE \t  =\n`\n<div class=\"frappe-capture\">\n\t<div class=\"panel panel-default\">\n\t\t<img class=\"fc-p img-responsive\"/>\n\t\t<div class=\"fc-s  embed-responsive embed-responsive-16by9\">\n\t\t\t<video class=\"embed-responsive-item\">${frappe.ui.Capture.ERR_MESSAGE}</video>\n\t\t</div>\n\t</div>\n\t<div>\n\t\t<div class=\"fc-btf\">\n\t\t\t<div class=\"row\">\n\t\t\t\t<div class=\"col-md-6\">\n\t\t\t\t\t<div class=\"pull-left\">\n\t\t\t\t\t\t<button class=\"btn btn-default fc-br\">\n\t\t\t\t\t\t\t<small>${__('Retake')}</small>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"col-md-6\">\n\t\t\t\t\t<div class=\"pull-right\">\n\t\t\t\t\t\t<button class=\"btn btn-primary fc-bs\">\n\t\t\t\t\t\t\t<small>${__('Submit')}</small>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"fc-btu\">\n\t\t\t<div class=\"row\">\n\t\t\t\t<div class=\"col-md-6\">\n\t\t\t\t\t${\n\t\t\t\t\t\t''\n\t\t\t\t\t\t// <div class=\"pull-left\">\n\t\t\t\t\t\t// \t<button class=\"btn btn-default\">\n\t\t\t\t\t\t// \t\t<small>${__('Take Video')}</small>\n\t\t\t\t\t\t// \t</button>\n\t\t\t\t\t\t// </div>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"col-md-6\">\n\t\t\t\t\t<div class=\"pull-right\">\n\t\t\t\t\t\t<button class=\"btn btn-default fc-bcp\">\n\t\t\t\t\t\t\t<small>${__('Take Photo')}</small>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n`","frappe.ui.form.make_control = function (opts) {\n\tvar control_class_name = \"Control\" + opts.df.fieldtype.replace(/ /g, \"\");\n\tif(frappe.ui.form[control_class_name]) {\n\t\treturn new frappe.ui.form[control_class_name](opts);\n\t} else {\n\t\t// eslint-disable-next-line\n\t\tconsole.log(\"Invalid Control Name: \" + opts.df.fieldtype);\n\t}\n};\n\nfrappe.ui.form.Control = Class.extend({\n\tinit: function(opts) {\n\t\t$.extend(this, opts);\n\t\tthis.make();\n\n\t\t// if developer_mode=1, show fieldname as tooltip\n\t\tif(frappe.boot.user && frappe.boot.user.name===\"Administrator\" &&\n\t\t\tfrappe.boot.developer_mode===1 && this.$wrapper) {\n\t\t\tthis.$wrapper.attr(\"title\", __(this.df.fieldname));\n\t\t}\n\n\t\tif(this.render_input) {\n\t\t\tthis.refresh();\n\t\t}\n\t},\n\tmake: function() {\n\t\tthis.make_wrapper();\n\t\tthis.$wrapper\n\t\t\t.attr(\"data-fieldtype\", this.df.fieldtype)\n\t\t\t.attr(\"data-fieldname\", this.df.fieldname);\n\t\tthis.wrapper = this.$wrapper.get(0);\n\t\tthis.wrapper.fieldobj = this; // reference for event handlers\n\t},\n\n\tmake_wrapper: function() {\n\t\tthis.$wrapper = $(\"<div class='frappe-control'></div>\").appendTo(this.parent);\n\n\t\t// alias\n\t\tthis.wrapper = this.$wrapper;\n\t},\n\n\ttoggle: function(show) {\n\t\tthis.df.hidden = show ? 0 : 1;\n\t\tthis.refresh();\n\t},\n\n\t// returns \"Read\", \"Write\" or \"None\"\n\t// as strings based on permissions\n\tget_status: function(explain) {\n\t\tif (this.df.get_status) {\n\t\t\treturn this.df.get_status(this);\n\t\t}\n\n\t\tif(!this.doctype && !this.docname) {\n\t\t\t// like in case of a dialog box\n\t\t\tif (cint(this.df.hidden)) {\n\t\t\t\t// eslint-disable-next-line\n\t\t\t\tif(explain) console.log(\"By Hidden: None\");\n\t\t\t\treturn \"None\";\n\n\t\t\t} else if (cint(this.df.hidden_due_to_dependency)) {\n\t\t\t\t// eslint-disable-next-line\n\t\t\t\tif(explain) console.log(\"By Hidden Dependency: None\");\n\t\t\t\treturn \"None\";\n\n\t\t\t} else if (cint(this.df.read_only)) {\n\t\t\t\t// eslint-disable-next-line\n\t\t\t\tif(explain) console.log(\"By Read Only: Read\");\n\t\t\t\treturn \"Read\";\n\n\t\t\t}\n\n\t\t\treturn \"Write\";\n\t\t}\n\n\t\tvar status = frappe.perm.get_field_display_status(this.df,\n\t\t\tfrappe.model.get_doc(this.doctype, this.docname), this.perm || (this.frm && this.frm.perm), explain);\n\n\t\t// hide if no value\n\t\tif (this.doctype && status===\"Read\" && !this.only_input\n\t\t\t&& is_null(frappe.model.get_value(this.doctype, this.docname, this.df.fieldname))\n\t\t\t&& !in_list([\"HTML\", \"Image\"], this.df.fieldtype)) {\n\n\t\t\t// eslint-disable-next-line\n\t\t\tif(explain) console.log(\"By Hide Read-only, null fields: None\");\n\t\t\tstatus = \"None\";\n\t\t}\n\n\t\treturn status;\n\t},\n\trefresh: function() {\n\t\tthis.disp_status = this.get_status();\n\t\tthis.$wrapper\n\t\t\t&& this.$wrapper.toggleClass(\"hide-control\", this.disp_status==\"None\")\n\t\t\t&& this.refresh_input\n\t\t\t&& this.refresh_input();\n\n\t\tvar value = this.get_value();\n\n\t\tthis.show_translatable_button(value);\n\t},\n\tshow_translatable_button(value) {\n\t\t// Disable translation non-string fields or special string fields\n\t\tif (!frappe.model\n\t\t\t|| !frappe.model.can_write('Translation')\n\t\t\t|| !this.frm\n\t\t\t|| !this.doc\n\t\t\t|| !this.df.translatable\n\t\t\t|| !value) return;\n\n\t\t// Disable translation in website\n\t\tif (!frappe.views || !frappe.views.TranslationManager) return;\n\n\t\t// Already attached button\n\t\tif (this.$wrapper.find('.clearfix .btn-translation').length) return;\n\n\t\tconst translation_btn =\n\t\t\t`<a class=\"btn-translation no-decoration text-muted\" title=\"${__('Open Translation')}\">\n\t\t\t\t<i class=\"fa fa-globe\"></i>\n\t\t\t</a>`;\n\n\t\t$(translation_btn)\n\t\t\t.appendTo(this.$wrapper.find('.clearfix'))\n\t\t\t.on('click', () => {\n\t\t\t\tif (!this.doc.__islocal) {\n\t\t\t\t\tnew frappe.views.TranslationManager({\n\t\t\t\t\t\t'df': this.df,\n\t\t\t\t\t\t'source_name': value,\n\t\t\t\t\t\t'target_language': this.doc.language,\n\t\t\t\t\t\t'doc': this.doc\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t},\n\tget_doc: function() {\n\t\treturn this.doctype && this.docname\n\t\t\t&& locals[this.doctype] && locals[this.doctype][this.docname] || {};\n\t},\n\tget_model_value: function() {\n\t\tif(this.doc) {\n\t\t\treturn this.doc[this.df.fieldname];\n\t\t}\n\t},\n\tset_value: function(value) {\n\t\treturn this.validate_and_set_in_model(value);\n\t},\n\tparse_validate_and_set_in_model: function(value, e) {\n\t\tif(this.parse) {\n\t\t\tvalue = this.parse(value);\n\t\t}\n\t\treturn this.validate_and_set_in_model(value, e);\n\t},\n\tvalidate_and_set_in_model: function(value, e) {\n\t\tvar me = this;\n\t\tif(this.inside_change_event) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.inside_change_event = true;\n\t\tvar set = function(value) {\n\t\t\tme.inside_change_event = false;\n\t\t\treturn frappe.run_serially([\n\t\t\t\t() => me.set_model_value(value),\n\t\t\t\t() => {\n\t\t\t\t\tme.set_mandatory && me.set_mandatory(value);\n\n\t\t\t\t\tif(me.df.change || me.df.onchange) {\n\t\t\t\t\t\t// onchange event specified in df\n\t\t\t\t\t\treturn (me.df.change || me.df.onchange).apply(me, [e]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]);\n\t\t};\n\n\t\tvalue = this.validate(value);\n\t\tif (value && value.then) {\n\t\t\t// got a promise\n\t\t\treturn value.then((value) => set(value));\n\t\t} else {\n\t\t\t// all clear\n\t\t\treturn set(value);\n\t\t}\n\t},\n\tget_value: function() {\n\t\tif(this.get_status()==='Write') {\n\t\t\treturn this.get_input_value ?\n\t\t\t\t(this.parse ? this.parse(this.get_input_value()) : this.get_input_value()) :\n\t\t\t\tundefined;\n\t\t} else {\n\t\t\treturn this.value || undefined;\n\t\t}\n\t},\n\tset_model_value: function(value) {\n\t\tif(this.doctype && this.docname) {\n\t\t\tthis.last_value = value;\n\t\t\treturn frappe.model.set_value(this.doctype, this.docname, this.df.fieldname,\n\t\t\t\tvalue, this.df.fieldtype);\n\t\t} else {\n\t\t\tif(this.doc) {\n\t\t\t\tthis.doc[this.df.fieldname] = value;\n\t\t\t}\n\t\t\tthis.set_input(value);\n\t\t\treturn Promise.resolve();\n\t\t}\n\t},\n\tset_focus: function() {\n\t\tif(this.$input) {\n\t\t\tthis.$input.get(0).focus();\n\t\t\treturn true;\n\t\t}\n\t}\n});\n","frappe.ui.form.ControlInput = frappe.ui.form.Control.extend({\n\thorizontal: true,\n\tmake: function() {\n\t\t// parent element\n\t\tthis._super();\n\t\tthis.set_input_areas();\n\n\t\t// set description\n\t\tthis.set_max_width();\n\t},\n\tmake_wrapper: function() {\n\t\tif(this.only_input) {\n\t\t\tthis.$wrapper = $('<div class=\"form-group frappe-control\">').appendTo(this.parent);\n\t\t} else {\n\t\t\tthis.$wrapper = $('<div class=\"frappe-control\">\\\n\t\t\t\t<div class=\"form-group\">\\\n\t\t\t\t\t<div class=\"clearfix\">\\\n\t\t\t\t\t\t<label class=\"control-label\" style=\"padding-right: 0px;\"></label>\\\n\t\t\t\t\t</div>\\\n\t\t\t\t\t<div class=\"control-input-wrapper\">\\\n\t\t\t\t\t\t<div class=\"control-input\"></div>\\\n\t\t\t\t\t\t<div class=\"control-value like-disabled-input\" style=\"display: none;\"></div>\\\n\t\t\t\t\t\t<p class=\"help-box small text-muted hidden-xs\"></p>\\\n\t\t\t\t\t</div>\\\n\t\t\t\t</div>\\\n\t\t\t</div>').appendTo(this.parent);\n\t\t}\n\t},\n\ttoggle_label: function(show) {\n\t\tthis.$wrapper.find(\".control-label\").toggleClass(\"hide\", !show);\n\t},\n\ttoggle_description: function(show) {\n\t\tthis.$wrapper.find(\".help-box\").toggleClass(\"hide\", !show);\n\t},\n\tset_input_areas: function() {\n\t\tif(this.only_input) {\n\t\t\tthis.input_area = this.wrapper;\n\t\t} else {\n\t\t\tthis.label_area = this.label_span = this.$wrapper.find(\"label\").get(0);\n\t\t\tthis.input_area = this.$wrapper.find(\".control-input\").get(0);\n\t\t\tthis.$input_wrapper = this.$wrapper.find(\".control-input-wrapper\");\n\t\t\t// keep a separate display area to rendered formatted values\n\t\t\t// like links, currencies, HTMLs etc.\n\t\t\tthis.disp_area = this.$wrapper.find(\".control-value\").get(0);\n\t\t}\n\t},\n\tset_max_width: function() {\n\t\tif(this.horizontal) {\n\t\t\tthis.$wrapper.addClass(\"input-max-width\");\n\t\t}\n\t},\n\n\t// update input value, label, description\n\t// display (show/hide/read-only),\n\t// mandatory style on refresh\n\trefresh_input: function() {\n\t\tvar me = this;\n\t\tvar make_input = function() {\n\t\t\tif(!me.has_input) {\n\t\t\t\tme.make_input();\n\t\t\t\tif(me.df.on_make) {\n\t\t\t\t\tme.df.on_make(me);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tvar update_input = function() {\n\t\t\tif(me.doctype && me.docname) {\n\t\t\t\tme.set_input(me.value);\n\t\t\t} else {\n\t\t\t\tme.set_input(me.value || null);\n\t\t\t}\n\t\t};\n\n\t\tif (me.disp_status != \"None\") {\n\t\t\t// refresh value\n\t\t\tif(me.doctype && me.docname) {\n\t\t\t\tme.value = frappe.model.get_value(me.doctype, me.docname, me.df.fieldname);\n\t\t\t}\n\n\t\t\tif(me.disp_status==\"Write\") {\n\t\t\t\tme.disp_area && $(me.disp_area).toggle(false);\n\t\t\t\t$(me.input_area).toggle(true);\n\t\t\t\tme.$input && me.$input.prop(\"disabled\", false);\n\t\t\t\tmake_input();\n\t\t\t\tupdate_input();\n\t\t\t} else {\n\t\t\t\tif(me.only_input) {\n\t\t\t\t\tmake_input();\n\t\t\t\t\tupdate_input();\n\t\t\t\t} else {\n\t\t\t\t\t$(me.input_area).toggle(false);\n\t\t\t\t\tif (me.disp_area) {\n\t\t\t\t\t\tme.set_disp_area(me.value);\n\t\t\t\t\t\t$(me.disp_area).toggle(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tme.$input && me.$input.prop(\"disabled\", true);\n\t\t\t}\n\n\t\t\tme.set_description();\n\t\t\tme.set_label();\n\t\t\tme.set_mandatory(me.value);\n\t\t\tme.set_bold();\n\t\t}\n\t},\n\n\tset_disp_area: function(value) {\n\t\tif(in_list([\"Currency\", \"Int\", \"Float\"], this.df.fieldtype)\n\t\t\t&& (this.value === 0 || value === 0)) {\n\t\t\t// to set the 0 value in readonly for currency, int, float field\n\t\t\tvalue = 0;\n\t\t} else {\n\t\t\tvalue = this.value || value;\n\t\t}\n\t\tthis.disp_area && $(this.disp_area)\n\t\t\t.html(frappe.format(value, this.df, {no_icon:true, inline:true},\n\t\t\t\tthis.doc || (this.frm && this.frm.doc)));\n\t},\n\n\tbind_change_event: function() {\n\t\tvar me = this;\n\t\tthis.$input && this.$input.on(\"change\", this.change || function(e) {\n\t\t\tme.parse_validate_and_set_in_model(me.get_input_value(), e);\n\t\t});\n\t},\n\tbind_focusout: function() {\n\t\t// on touchscreen devices, scroll to top\n\t\t// so that static navbar and page head don't overlap the input\n\t\tif (frappe.dom.is_touchscreen()) {\n\t\t\tvar me = this;\n\t\t\tthis.$input && this.$input.on(\"focusout\", function() {\n\t\t\t\tif (frappe.dom.is_touchscreen()) {\n\t\t\t\t\tfrappe.utils.scroll_to(me.$wrapper);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\tset_label: function(label) {\n\t\tif(label) this.df.label = label;\n\n\t\tif(this.only_input || this.df.label==this._label)\n\t\t\treturn;\n\n\t\tvar icon = \"\";\n\t\tthis.label_span.innerHTML = (icon ? '<i class=\"'+icon+'\"></i> ' : \"\") +\n\t\t\t__(this.df.label)  || \"&nbsp;\";\n\t\tthis._label = this.df.label;\n\t},\n\tset_description: function(description) {\n\t\tif (description !== undefined) {\n\t\t\tthis.df.description = description;\n\t\t}\n\t\tif (this.only_input || this.df.description===this._description) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.df.description) {\n\t\t\tthis.$wrapper.find(\".help-box\").html(__(this.df.description));\n\t\t} else {\n\t\t\tthis.set_empty_description();\n\t\t}\n\t\tthis._description = this.df.description;\n\t},\n\tset_new_description: function(description) {\n\t\tthis.$wrapper.find(\".help-box\").html(description);\n\t},\n\tset_empty_description: function() {\n\t\tthis.$wrapper.find(\".help-box\").html(\"\");\n\t},\n\tset_mandatory: function(value) {\n\t\tthis.$wrapper.toggleClass(\"has-error\", (this.df.reqd && is_null(value)) ? true : false);\n\t},\n\tset_bold: function() {\n\t\tif(this.$input) {\n\t\t\tthis.$input.toggleClass(\"bold\", !!(this.df.bold || this.df.reqd));\n\t\t}\n\t\tif(this.disp_area) {\n\t\t\t$(this.disp_area).toggleClass(\"bold\", !!(this.df.bold || this.df.reqd));\n\t\t}\n\t}\n});\n","frappe.ui.form.ControlData = frappe.ui.form.ControlInput.extend({\n\thtml_element: \"input\",\n\tinput_type: \"text\",\n\tmake_input: function() {\n\t\tif(this.$input) return;\n\n\t\tthis.$input = $(\"<\"+ this.html_element +\">\")\n\t\t\t.attr(\"type\", this.input_type)\n\t\t\t.attr(\"autocomplete\", \"off\")\n\t\t\t.addClass(\"input-with-feedback form-control\")\n\t\t\t.prependTo(this.input_area);\n\n\t\tif (in_list(['Data', 'Link', 'Dynamic Link', 'Password', 'Select', 'Read Only', 'Attach', 'Attach Image'],\n\t\t\tthis.df.fieldtype)) {\n\t\t\tthis.$input.attr(\"maxlength\", this.df.length || 140);\n\t\t}\n\n\t\tthis.set_input_attributes();\n\t\tthis.input = this.$input.get(0);\n\t\tthis.has_input = true;\n\t\tthis.bind_change_event();\n\t\tthis.bind_focusout();\n\t\tthis.setup_autoname_check();\n\n\t\t// somehow this event does not bubble up to document\n\t\t// after v7, if you can debug, remove this\n\t},\n\tsetup_autoname_check: function() {\n\t\tif (!this.df.parent) return;\n\t\tthis.meta = frappe.get_meta(this.df.parent);\n\t\tif (this.meta && ((this.meta.autoname\n\t\t\t&& this.meta.autoname.substr(0, 6)==='field:'\n\t\t\t&& this.meta.autoname.substr(6) === this.df.fieldname) || this.df.fieldname==='__newname') ) {\n\t\t\tthis.$input.on('keyup', () => {\n\t\t\t\tthis.set_description('');\n\t\t\t\tif (this.doc && this.doc.__islocal) {\n\t\t\t\t\t// check after 1 sec\n\t\t\t\t\tlet timeout = setTimeout(() => {\n\t\t\t\t\t\t// clear any pending calls\n\t\t\t\t\t\tif (this.last_check) clearTimeout(this.last_check);\n\n\t\t\t\t\t\t// check if name exists\n\t\t\t\t\t\tfrappe.db.get_value(this.doctype, this.$input.val(),\n\t\t\t\t\t\t\t'name', (val) => {\n\t\t\t\t\t\t\t\tif (val) {\n\t\t\t\t\t\t\t\t\tthis.set_description(__('{0} already exists. Select another name', [val.name]));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.last_check = null;\n\t\t\t\t\t}, 1000);\n\t\t\t\t\tthis.last_check = timeout;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\tset_input_attributes: function() {\n\t\tthis.$input\n\t\t\t.attr(\"data-fieldtype\", this.df.fieldtype)\n\t\t\t.attr(\"data-fieldname\", this.df.fieldname)\n\t\t\t.attr(\"placeholder\", this.df.placeholder || \"\");\n\t\tif(this.doctype) {\n\t\t\tthis.$input.attr(\"data-doctype\", this.doctype);\n\t\t}\n\t\tif(this.df.input_css) {\n\t\t\tthis.$input.css(this.df.input_css);\n\t\t}\n\t\tif(this.df.input_class) {\n\t\t\tthis.$input.addClass(this.df.input_class);\n\t\t}\n\t},\n\tset_input: function(value) {\n\t\tthis.last_value = this.value;\n\t\tthis.value = value;\n\t\tthis.set_formatted_input(value);\n\t\tthis.set_disp_area(value);\n\t\tthis.set_mandatory && this.set_mandatory(value);\n\t},\n\tset_formatted_input: function(value) {\n\t\tthis.$input && this.$input.val(this.format_for_input(value));\n\t},\n\tget_input_value: function() {\n\t\treturn this.$input ? this.$input.val() : undefined;\n\t},\n\tformat_for_input: function(val) {\n\t\treturn val==null ? \"\" : val;\n\t},\n\tvalidate: function(v) {\n\t\tif(this.df.options == 'Phone') {\n\t\t\tif(v+''=='') {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tvar v1 = '';\n\t\t\t// phone may start with + and must only have numbers later, '-' and ' ' are stripped\n\t\t\tv = v.replace(/ /g, '').replace(/-/g, '').replace(/\\(/g, '').replace(/\\)/g, '');\n\n\t\t\t// allow initial +,0,00\n\t\t\tif(v && v.substr(0,1)=='+') {\n\t\t\t\tv1 = '+'; v = v.substr(1);\n\t\t\t}\n\t\t\tif(v && v.substr(0,2)=='00') {\n\t\t\t\tv1 += '00'; v = v.substr(2);\n\t\t\t}\n\t\t\tif(v && v.substr(0,1)=='0') {\n\t\t\t\tv1 += '0'; v = v.substr(1);\n\t\t\t}\n\t\t\tv1 += cint(v) + '';\n\t\t\treturn v1;\n\t\t} else if(this.df.options == 'Email') {\n\t\t\tif(v+''=='') {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tvar email_list = frappe.utils.split_emails(v);\n\t\t\tif (!email_list) {\n\t\t\t\t// invalid email\n\t\t\t\treturn '';\n\t\t\t} else {\n\t\t\t\tvar invalid_email = false;\n\t\t\t\temail_list.forEach(function(email) {\n\t\t\t\t\tif (!validate_email(email)) {\n\t\t\t\t\t\tfrappe.msgprint(__(\"Invalid Email: {0}\", [email]));\n\t\t\t\t\t\tinvalid_email = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (invalid_email) {\n\t\t\t\t\t// at least 1 invalid email\n\t\t\t\t\treturn '';\n\t\t\t\t} else {\n\t\t\t\t\t// all good\n\t\t\t\t\treturn v;\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\treturn v;\n\t\t}\n\t}\n});\n","frappe.ui.form.ControlInt = frappe.ui.form.ControlData.extend({\n\tmake: function() {\n\t\tthis._super();\n\t\t// $(this.label_area).addClass('pull-right');\n\t\t// $(this.disp_area).addClass('text-right');\n\t},\n\tmake_input: function() {\n\t\tvar me = this;\n\t\tthis._super();\n\t\tthis.$input\n\t\t\t// .addClass(\"text-right\")\n\t\t\t.on(\"focus\", function() {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tif(!document.activeElement) return;\n\t\t\t\t\tdocument.activeElement.value\n\t\t\t\t\t\t= me.validate(document.activeElement.value);\n\t\t\t\t\tdocument.activeElement.select();\n\t\t\t\t}, 100);\n\t\t\t\treturn false;\n\t\t\t});\n\t},\n\tparse: function(value) {\n\t\treturn cint(value, null);\n\t}\n});\n","frappe.ui.form.ControlFloat = frappe.ui.form.ControlInt.extend({\n\tparse: function(value) {\n\t\treturn isNaN(parseFloat(value)) ? null : flt(value, this.get_precision());\n\t},\n\n\tformat_for_input: function(value) {\n\t\tvar number_format;\n\t\tif (this.df.fieldtype===\"Float\" && this.df.options && this.df.options.trim()) {\n\t\t\tnumber_format = this.get_number_format();\n\t\t}\n\t\tvar formatted_value = format_number(parseFloat(value), number_format, this.get_precision());\n\t\treturn isNaN(parseFloat(value)) ? \"\" : formatted_value;\n\t},\n\n\t// even a float field can be formatted based on currency format instead of float format\n\tget_number_format: function() {\n\t\tvar currency = frappe.meta.get_field_currency(this.df, this.get_doc());\n\t\treturn get_number_format(currency);\n\t},\n\n\tget_precision: function() {\n\t\t// round based on field precision or float precision, else don't round\n\t\treturn this.df.precision || cint(frappe.boot.sysdefaults.float_precision, null);\n\t}\n});\n\nfrappe.ui.form.ControlPercent = frappe.ui.form.ControlFloat;\n","frappe.ui.form.ControlCurrency = frappe.ui.form.ControlFloat.extend({\n\tformat_for_input: function(value) {\n\t\tvar formatted_value = format_number(parseFloat(value), this.get_number_format(), this.get_precision());\n\t\treturn isNaN(parseFloat(value)) ? \"\" : formatted_value;\n\t},\n\n\tget_precision: function() {\n\t\t// always round based on field precision or currency's precision\n\t\t// this method is also called in this.parse()\n\t\tif (!this.df.precision) {\n\t\t\tif(frappe.boot.sysdefaults.currency_precision) {\n\t\t\t\tthis.df.precision = frappe.boot.sysdefaults.currency_precision;\n\t\t\t} else {\n\t\t\t\tthis.df.precision = get_number_format_info(this.get_number_format()).precision;\n\t\t\t}\n\t\t}\n\n\t\treturn this.df.precision;\n\t}\n});\n","frappe.ui.form.ControlDate = frappe.ui.form.ControlData.extend({\n\tmake_input: function() {\n\t\tthis._super();\n\t\tthis.set_date_options();\n\t\tthis.set_datepicker();\n\t\tthis.set_t_for_today();\n\t},\n\tset_formatted_input: function(value) {\n\t\tthis._super(value);\n\t\tif(!value) return;\n\n\t\tlet should_refresh = this.last_value && this.last_value !== value;\n\n\t\tif (!should_refresh) {\n\t\t\tif(this.datepicker.selectedDates.length > 0) {\n\t\t\t\t// if date is selected but different from value, refresh\n\t\t\t\tconst selected_date =\n\t\t\t\t\tmoment(this.datepicker.selectedDates[0])\n\t\t\t\t\t\t.format(this.date_format);\n\t\t\t\tshould_refresh = selected_date !== value;\n\t\t\t} else {\n\t\t\t\t// if datepicker has no selected date, refresh\n\t\t\t\tshould_refresh = true;\n\t\t\t}\n\t\t}\n\n\t\tif(should_refresh) {\n\t\t\tthis.datepicker.selectDate(frappe.datetime.str_to_obj(value));\n\t\t}\n\t},\n\tset_date_options: function() {\n\t\tvar me = this;\n\t\tvar lang = frappe.boot.user.language;\n\t\tif(!$.fn.datepicker.language[lang]) {\n\t\t\tlang = 'en';\n\t\t}\n\t\tthis.today_text = __(\"Today\");\n\t\tthis.date_format = moment.defaultDateFormat;\n\t\tthis.datepicker_options = {\n\t\t\tlanguage: lang,\n\t\t\tautoClose: true,\n\t\t\ttodayButton: true,\n\t\t\tdateFormat: (frappe.boot.sysdefaults.date_format || 'yyyy-mm-dd'),\n\t\t\tstartDate: frappe.datetime.now_date(true),\n\t\t\tkeyboardNav: false,\n\t\t\tonSelect: () => {\n\t\t\t\tthis.$input.trigger('change');\n\t\t\t},\n\t\t\tonShow: () => {\n\t\t\t\tthis.datepicker.$datepicker\n\t\t\t\t\t.find('.datepicker--button:visible')\n\t\t\t\t\t.text(me.today_text);\n\n\t\t\t\tthis.update_datepicker_position();\n\t\t\t}\n\t\t};\n\t},\n\tupdate_datepicker_position: function() {\n\t\tif(!this.frm) return;\n\t\t// show datepicker above or below the input\n\t\t// based on scroll position\n\t\tvar window_height = $(window).height();\n\t\tvar window_scroll_top = $(window).scrollTop();\n\t\tvar el_offset_top = this.$input.offset().top + 280;\n\t\tvar position = 'top left';\n\t\tif(window_height + window_scroll_top >= el_offset_top) {\n\t\t\tposition = 'bottom left';\n\t\t}\n\t\tthis.datepicker.update('position', position);\n\t},\n\tset_datepicker: function() {\n\t\tthis.$input.datepicker(this.datepicker_options);\n\t\tthis.datepicker = this.$input.data('datepicker');\n\n\t\t// today button didn't work as expected,\n\t\t// so explicitly bind the event\n\t\tthis.datepicker.$datepicker\n\t\t\t.find('[data-action=\"today\"]')\n\t\t\t.click(() => {\n\t\t\t\tthis.datepicker.selectDate(this.get_now_date());\n\t\t\t});\n\t},\n\tget_now_date: function() {\n\t\treturn frappe.datetime.now_date(true);\n\t},\n\tset_t_for_today: function() {\n\t\tvar me = this;\n\t\tthis.$input.on(\"keydown\", function(e) {\n\t\t\tif(e.which===84) { // 84 === t\n\t\t\t\tif(me.df.fieldtype=='Date') {\n\t\t\t\t\tme.set_value(frappe.datetime.nowdate());\n\t\t\t\t} if(me.df.fieldtype=='Datetime') {\n\t\t\t\t\tme.set_value(frappe.datetime.now_datetime());\n\t\t\t\t} if(me.df.fieldtype=='Time') {\n\t\t\t\t\tme.set_value(frappe.datetime.now_time());\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tparse: function(value) {\n\t\tif(value) {\n\t\t\treturn frappe.datetime.user_to_str(value);\n\t\t}\n\t},\n\tformat_for_input: function(value) {\n\t\tif(value) {\n\t\t\treturn frappe.datetime.str_to_user(value);\n\t\t}\n\t\treturn \"\";\n\t},\n\tvalidate: function(value) {\n\t\tif(value && !frappe.datetime.validate(value)) {\n\t\t\tfrappe.msgprint(__(\"Date must be in format: {0}\", [frappe.sys_defaults.date_format || \"yyyy-mm-dd\"]));\n\t\t\treturn '';\n\t\t}\n\t\treturn value;\n\t}\n});\n","frappe.ui.form.ControlTime = frappe.ui.form.ControlData.extend({\n\tmake_input: function() {\n\t\tvar me = this;\n\t\tthis._super();\n\t\tthis.$input.datepicker({\n\t\t\tlanguage: \"en\",\n\t\t\ttimepicker: true,\n\t\t\tonlyTimepicker: true,\n\t\t\ttimeFormat: \"hh:ii:ss\",\n\t\t\tstartDate: frappe.datetime.now_time(true),\n\t\t\tonSelect: function() {\n\t\t\t\t// ignore micro seconds\n\t\t\t\tif (moment(me.get_value(), 'hh:mm:ss').format('HH:mm:ss') != moment(me.value, 'hh:mm:ss').format('HH:mm:ss')) {\n\t\t\t\t\tme.$input.trigger('change');\n\t\t\t\t}\t\t\t\t\n\t\t\t},\n\t\t\tonShow: function() {\n\t\t\t\t$('.datepicker--button:visible').text(__('Now'));\n\t\t\t},\n\t\t\tkeyboardNav: false,\n\t\t\ttodayButton: true\n\t\t});\n\t\tthis.datepicker = this.$input.data('datepicker');\n\t\tthis.datepicker.$datepicker\n\t\t\t.find('[data-action=\"today\"]')\n\t\t\t.click(() => {\n\t\t\t\tthis.datepicker.selectDate(frappe.datetime.now_time(true));\n\t\t\t});\n\t\tthis.refresh();\n\t},\n\tset_input: function(value) {\n\t\tthis._super(value);\n\t\tif(value\n\t\t\t&& ((this.last_value && this.last_value !== this.value)\n\t\t\t\t|| (!this.datepicker.selectedDates.length))) {\n\n\t\t\tvar date_obj = frappe.datetime.moment_to_date_obj(moment(value, 'HH:mm:ss'));\n\t\t\tthis.datepicker.selectDate(date_obj);\n\t\t}\n\t},\n\tset_description: function() {\n\t\tconst { description } = this.df;\n\t\tconst { time_zone } = frappe.sys_defaults;\n\t\tif (!frappe.datetime.is_timezone_same()) {\n\t\t\tif (!description) {\n\t\t\t\tthis.df.description = time_zone;\n\t\t\t} else if (!description.includes(time_zone)) {\n\t\t\t\tthis.df.description += '<br>' + time_zone;\n\t\t\t}\n\t\t}\n\t\tthis._super();\n\t}\n});\n","frappe.ui.form.ControlDatetime = frappe.ui.form.ControlDate.extend({\n\tset_date_options: function() {\n\t\tthis._super();\n\t\tthis.today_text = __(\"Now\");\n\t\tthis.date_format = moment.defaultDatetimeFormat;\n\t\t$.extend(this.datepicker_options, {\n\t\t\ttimepicker: true,\n\t\t\ttimeFormat: \"hh:ii:ss\"\n\t\t});\n\t},\n\tget_now_date: function() {\n\t\treturn frappe.datetime.now_datetime(true);\n\t},\n\tset_description: function() {\n\t\tconst { description } = this.df;\n\t\tconst { time_zone } = frappe.sys_defaults;\n\t\tif (!frappe.datetime.is_timezone_same()) {\n\t\t\tif (!description) {\n\t\t\t\tthis.df.description = time_zone;\n\t\t\t} else if (!description.includes(time_zone)) {\n\t\t\t\tthis.df.description += '<br>' + time_zone;\n\t\t\t}\n\t\t}\n\t\tthis._super();\n\t}\n});\n","frappe.ui.form.ControlDateRange = frappe.ui.form.ControlData.extend({\n\tmake_input: function() {\n\t\tthis._super();\n\t\tthis.set_date_options();\n\t\tthis.set_datepicker();\n\t\tthis.refresh();\n\t},\n\tset_date_options: function() {\n\t\tvar me = this;\n\t\tthis.datepicker_options = {\n\t\t\tlanguage: \"en\",\n\t\t\trange: true,\n\t\t\tautoClose: true,\n\t\t\ttoggleSelected: false\n\t\t};\n\t\tthis.datepicker_options.dateFormat =\n\t\t\t(frappe.boot.sysdefaults.date_format || 'yyyy-mm-dd');\n\t\tthis.datepicker_options.onSelect = function() {\n\t\t\tme.$input.trigger('change');\n\t\t};\n\t},\n\tset_datepicker: function() {\n\t\tthis.$input.datepicker(this.datepicker_options);\n\t\tthis.datepicker = this.$input.data('datepicker');\n\t},\n\tset_input: function(value, value2) {\n\t\tthis.last_value = this.value;\n\t\tif (value && value2) {\n\t\t\tthis.value = [value, value2];\n\t\t} else {\n\t\t\tthis.value = value;\n\t\t}\n\t\tif (this.value) {\n\t\t\tlet formatted = this.format_for_input(this.value[0], this.value[1]);\n\t\t\tthis.$input && this.$input.val(formatted);\n\t\t} else {\n\t\t\tthis.$input && this.$input.val(\"\");\n\t\t}\n\t\tthis.set_disp_area(value || '');\n\t\tthis.set_mandatory && this.set_mandatory(value);\n\t},\n\tparse: function(value) {\n\t\t// replace the separator (which can be in user language) with comma\n\t\tconst to = __('{0} to {1}').replace('{0}', '').replace('{1}', '');\n\t\tvalue = value.replace(to, ',');\n\n\t\tif(value && value.includes(',')) {\n\t\t\tvar vals = value.split(',');\n\t\t\tvar from_date = moment(frappe.datetime.user_to_obj(vals[0])).format('YYYY-MM-DD');\n\t\t\tvar to_date = moment(frappe.datetime.user_to_obj(vals[vals.length-1])).format('YYYY-MM-DD');\n\t\t\treturn [from_date, to_date];\n\t\t}\n\t},\n\tformat_for_input: function(value1, value2) {\n\t\tif(value1 && value2) {\n\t\t\tvalue1 = frappe.datetime.str_to_user(value1);\n\t\t\tvalue2 = frappe.datetime.str_to_user(value2);\n\t\t\treturn __(\"{0} to {1}\", [value1, value2]);\n\t\t}\n\t\treturn \"\";\n\t}\n});\n","frappe.ui.form.ControlSelect = frappe.ui.form.ControlData.extend({\n\thtml_element: \"select\",\n\tmake_input: function() {\n\t\tthis._super();\n\t\tthis.set_options();\n\t},\n\tset_formatted_input: function(value) {\n\t\t// refresh options first - (new ones??)\n\t\tif(value==null) value = '';\n\t\tthis.set_options(value);\n\n\t\t// set in the input element\n\t\tthis._super(value);\n\n\t\t// check if the value to be set is selected\n\t\tvar input_value = '';\n\t\tif(this.$input) {\n\t\t\tinput_value = this.$input.val();\n\t\t}\n\n\t\tif(value && input_value && value !== input_value) {\n\t\t\t// trying to set a non-existant value\n\t\t\t// model value must be same as whatever the input is\n\t\t\tthis.set_model_value(input_value);\n\t\t}\n\t},\n\tset_options: function(value) {\n\t\t// reset options, if something new is set\n\t\tvar options = this.df.options || [];\n\n\t\tif(typeof this.df.options===\"string\") {\n\t\t\toptions = this.df.options.split(\"\\n\");\n\t\t}\n\n\t\t// nothing changed\n\t\tif(options.toString() === this.last_options) {\n\t\t\treturn;\n\t\t}\n\t\tthis.last_options = options.toString();\n\n\t\tif(this.$input) {\n\t\t\tvar selected = this.$input.find(\":selected\").val();\n\t\t\tthis.$input.empty().add_options(options || []);\n\n\t\t\tif(value===undefined && selected) {\n\t\t\t\tthis.$input.val(selected);\n\t\t\t}\n\t\t}\n\t},\n\tget_file_attachment_list: function() {\n\t\tif(!this.frm) return;\n\t\tvar fl = frappe.model.docinfo[this.frm.doctype][this.frm.docname];\n\t\tif(fl && fl.attachments) {\n\t\t\tthis.set_description(\"\");\n\t\t\tvar options = [\"\"];\n\t\t\t$.each(fl.attachments, function(i, f) {\n\t\t\t\toptions.push(f.file_url);\n\t\t\t});\n\t\t\treturn options;\n\t\t} else {\n\t\t\tthis.set_description(__(\"Please attach a file first.\"));\n\t\t\treturn [\"\"];\n\t\t}\n\t}\n});\n","// special features for link\n// buttons\n// autocomplete\n// link validation\n// custom queries\n// add_fetches\nfrappe.ui.form.ControlLink = frappe.ui.form.ControlData.extend({\n\tmake_input: function() {\n\t\tvar me = this;\n\t\t// line-height: 1 is for Mozilla 51, shows extra padding otherwise\n\t\t$('<div class=\"link-field ui-front\" style=\"position: relative; line-height: 1;\">\\\n\t\t\t<input type=\"text\" class=\"input-with-feedback form-control\">\\\n\t\t\t<span class=\"link-btn\">\\\n\t\t\t\t<a class=\"btn-open no-decoration\" title=\"' + __(\"Open Link\") + '\">\\\n\t\t\t\t\t<i class=\"octicon octicon-arrow-right\"></i></a>\\\n\t\t\t</span>\\\n\t\t</div>').prependTo(this.input_area);\n\t\tthis.$input_area = $(this.input_area);\n\t\tthis.$input = this.$input_area.find('input');\n\t\tthis.$link = this.$input_area.find('.link-btn');\n\t\tthis.$link_open = this.$link.find('.btn-open');\n\t\tthis.set_input_attributes();\n\t\tthis.$input.on(\"focus\", function() {\n\t\t\tsetTimeout(function() {\n\t\t\t\tif(me.$input.val() && me.get_options()) {\n\t\t\t\t\tme.$link.toggle(true);\n\t\t\t\t\tme.$link_open.attr('href', '#Form/' + me.get_options() + '/' + me.$input.val());\n\t\t\t\t}\n\n\t\t\t\tif(!me.$input.val()) {\n\t\t\t\t\tme.$input.val(\"\").trigger(\"input\");\n\t\t\t\t}\n\t\t\t}, 500);\n\t\t});\n\t\tthis.$input.on(\"blur\", function() {\n\t\t\t// if this disappears immediately, the user's click\n\t\t\t// does not register, hence timeout\n\t\t\tsetTimeout(function() {\n\t\t\t\tme.$link.toggle(false);\n\t\t\t}, 500);\n\t\t});\n\t\tthis.input = this.$input.get(0);\n\t\tthis.has_input = true;\n\t\tthis.translate_values = true;\n\t\tthis.setup_buttons();\n\t\tthis.setup_awesomeplete();\n\t},\n\tget_options: function() {\n\t\treturn this.df.options;\n\t},\n\tsetup_buttons: function() {\n\t\tif(this.only_input && !this.with_link_btn) {\n\t\t\tthis.$input_area.find(\".link-btn\").remove();\n\t\t}\n\t},\n\topen_advanced_search: function() {\n\t\tvar doctype = this.get_options();\n\t\tif(!doctype) return;\n\t\tnew frappe.ui.form.LinkSelector({\n\t\t\tdoctype: doctype,\n\t\t\ttarget: this,\n\t\t\ttxt: this.get_input_value()\n\t\t});\n\t\treturn false;\n\t},\n\tnew_doc: function() {\n\t\tvar doctype = this.get_options();\n\t\tvar me = this;\n\n\t\tif(!doctype) return;\n\n\t\t// set values to fill in the new document\n\t\tif(this.df.get_route_options_for_new_doc) {\n\t\t\tfrappe.route_options = this.df.get_route_options_for_new_doc(this);\n\t\t} else {\n\t\t\tfrappe.route_options = {};\n\t\t}\n\n\t\t// partially entered name field\n\t\tfrappe.route_options.name_field = this.get_value();\n\n\t\t// reference to calling link\n\t\tfrappe._from_link = this;\n\t\tfrappe._from_link_scrollY = $(document).scrollTop();\n\n\t\tfrappe.ui.form.make_quick_entry(doctype, (doc) => {\n\t\t\treturn me.set_value(doc.name);\n\t\t});\n\n\t\treturn false;\n\t},\n\tsetup_awesomeplete: function() {\n\t\tvar me = this;\n\n\t\tthis.$input.cache = {};\n\n\t\tthis.awesomplete = new Awesomplete(me.input, {\n\t\t\tminChars: 0,\n\t\t\tmaxItems: 99,\n\t\t\tautoFirst: true,\n\t\t\tlist: [],\n\t\t\tdata: function (item) {\n\t\t\t\treturn {\n\t\t\t\t\tlabel: item.label || item.value,\n\t\t\t\t\tvalue: item.value\n\t\t\t\t};\n\t\t\t},\n\t\t\tfilter: function() {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\titem: function (item) {\n\t\t\t\tvar d = this.get_item(item.value);\n\t\t\t\tif(!d.label) {\td.label = d.value; }\n\n\t\t\t\tvar _label = (me.translate_values) ? __(d.label) : d.label;\n\t\t\t\tvar html = \"<strong>\" + _label + \"</strong>\";\n\t\t\t\tif(d.description && d.value!==d.description) {\n\t\t\t\t\thtml += '<br><span class=\"small\">' + __(d.description) + '</span>';\n\t\t\t\t}\n\t\t\t\treturn $('<li></li>')\n\t\t\t\t\t.data('item.autocomplete', d)\n\t\t\t\t\t.prop('aria-selected', 'false')\n\t\t\t\t\t.html('<a><p>' + html + '</p></a>')\n\t\t\t\t\t.get(0);\n\t\t\t},\n\t\t\tsort: function() {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\n\t\tthis.$input.on(\"input\", frappe.utils.debounce(function(e) {\n\t\t\tvar doctype = me.get_options();\n\t\t\tif(!doctype) return;\n\t\t\tif (!me.$input.cache[doctype]) {\n\t\t\t\tme.$input.cache[doctype] = {};\n\t\t\t}\n\n\t\t\tvar term = e.target.value;\n\n\t\t\tif (me.$input.cache[doctype][term]!=null) {\n\t\t\t\t// immediately show from cache\n\t\t\t\tme.awesomplete.list = me.$input.cache[doctype][term];\n\t\t\t}\n\n\t\t\tvar args = {\n\t\t\t\t'txt': term,\n\t\t\t\t'doctype': doctype,\n\t\t\t};\n\n\t\t\tme.set_custom_query(args);\n\n\t\t\tfrappe.call({\n\t\t\t\ttype: \"GET\",\n\t\t\t\tmethod:'frappe.desk.search.search_link',\n\t\t\t\tno_spinner: true,\n\t\t\t\targs: args,\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\tif(!me.$input.is(\":focus\")) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(!me.df.only_select) {\n\t\t\t\t\t\tif(frappe.model.can_create(doctype)\n\t\t\t\t\t\t\t&& me.df.fieldtype !== \"Dynamic Link\") {\n\t\t\t\t\t\t\t// new item\n\t\t\t\t\t\t\tr.results.push({\n\t\t\t\t\t\t\t\tlabel: \"<span class='text-primary link-option'>\"\n\t\t\t\t\t\t\t\t\t+ \"<i class='fa fa-plus' style='margin-right: 5px;'></i> \"\n\t\t\t\t\t\t\t\t\t+ __(\"Create a new {0}\", [__(me.df.options)])\n\t\t\t\t\t\t\t\t\t+ \"</span>\",\n\t\t\t\t\t\t\t\tvalue: \"create_new__link_option\",\n\t\t\t\t\t\t\t\taction: me.new_doc\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// advanced search\n\t\t\t\t\t\tr.results.push({\n\t\t\t\t\t\t\tlabel: \"<span class='text-primary link-option'>\"\n\t\t\t\t\t\t\t\t+ \"<i class='fa fa-search' style='margin-right: 5px;'></i> \"\n\t\t\t\t\t\t\t\t+ __(\"Advanced Search\")\n\t\t\t\t\t\t\t\t+ \"</span>\",\n\t\t\t\t\t\t\tvalue: \"advanced_search__link_option\",\n\t\t\t\t\t\t\taction: me.open_advanced_search\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tme.$input.cache[doctype][term] = r.results;\n\t\t\t\t\tme.awesomplete.list = me.$input.cache[doctype][term];\n\t\t\t\t}\n\t\t\t});\n\t\t}, 618));\n\n\t\tthis.$input.on(\"blur\", function() {\n\t\t\tif(me.selected) {\n\t\t\t\tme.selected = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar value = me.get_input_value();\n\t\t\tif(value!==me.last_value) {\n\t\t\t\tme.parse_validate_and_set_in_model(value);\n\t\t\t}\n\t\t});\n\n\t\tthis.$input.on(\"awesomplete-open\", function() {\n\t\t\tme.$wrapper.css({\"z-index\": 100});\n\t\t\tme.$wrapper.find('ul').css({\"z-index\": 100});\n\t\t\tme.autocomplete_open = true;\n\t\t});\n\n\t\tthis.$input.on(\"awesomplete-close\", function() {\n\t\t\tme.$wrapper.css({\"z-index\": 1});\n\t\t\tme.autocomplete_open = false;\n\t\t});\n\n\t\tthis.$input.on(\"awesomplete-select\", function(e) {\n\t\t\tvar o = e.originalEvent;\n\t\t\tvar item = me.awesomplete.get_item(o.text.value);\n\n\t\t\tme.autocomplete_open = false;\n\n\t\t\t// prevent selection on tab\n\t\t\tvar TABKEY = 9;\n\t\t\tif(e.keyCode === TABKEY) {\n\t\t\t\te.preventDefault();\n\t\t\t\tme.awesomplete.close();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif(item.action) {\n\t\t\t\titem.value = \"\";\n\t\t\t\titem.action.apply(me);\n\t\t\t}\n\n\t\t\t// if remember_last_selected is checked in the doctype against the field,\n\t\t\t// then add this value\n\t\t\t// to defaults so you do not need to set it again\n\t\t\t// unless it is changed.\n\t\t\tif(me.df.remember_last_selected_value) {\n\t\t\t\tfrappe.boot.user.last_selected_values[me.df.options] = item.value;\n\t\t\t}\n\n\t\t\tme.parse_validate_and_set_in_model(item.value);\n\t\t});\n\n\t\tthis.$input.on(\"awesomplete-selectcomplete\", function(e) {\n\t\t\tvar o = e.originalEvent;\n\t\t\tif(o.text.value.indexOf(\"__link_option\") !== -1) {\n\t\t\t\tme.$input.val(\"\");\n\t\t\t}\n\t\t});\n\t},\n\tset_custom_query: function(args) {\n\t\tvar set_nulls = function(obj) {\n\t\t\t$.each(obj, function(key, value) {\n\t\t\t\tif(value!==undefined) {\n\t\t\t\t\tobj[key] = value;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn obj;\n\t\t};\n\t\tif(this.get_query || this.df.get_query) {\n\t\t\tvar get_query = this.get_query || this.df.get_query;\n\t\t\tif($.isPlainObject(get_query)) {\n\t\t\t\tvar filters = null;\n\t\t\t\tif(get_query.filters) {\n\t\t\t\t\t// passed as {'filters': {'key':'value'}}\n\t\t\t\t\tfilters = get_query.filters;\n\t\t\t\t} else if(get_query.query) {\n\n\t\t\t\t\t// passed as {'query': 'path.to.method'}\n\t\t\t\t\targs.query = get_query;\n\t\t\t\t} else {\n\n\t\t\t\t\t// dict is filters\n\t\t\t\t\tfilters = get_query;\n\t\t\t\t}\n\n\t\t\t\tif (filters) {\n\t\t\t\t\tfilters = set_nulls(filters);\n\n\t\t\t\t\t// extend args for custom functions\n\t\t\t\t\t$.extend(args, filters);\n\n\t\t\t\t\t// add \"filters\" for standard query (search.py)\n\t\t\t\t\targs.filters = filters;\n\t\t\t\t}\n\t\t\t} else if(typeof(get_query)===\"string\") {\n\t\t\t\targs.query = get_query;\n\t\t\t} else {\n\t\t\t\t// get_query by function\n\t\t\t\tvar q = (get_query)(this.frm && this.frm.doc || this.doc, this.doctype, this.docname);\n\n\t\t\t\tif (typeof(q)===\"string\") {\n\t\t\t\t\t// returns a string\n\t\t\t\t\targs.query = q;\n\t\t\t\t} else if($.isPlainObject(q)) {\n\t\t\t\t\t// returns a plain object with filters\n\t\t\t\t\tif(q.filters) {\n\t\t\t\t\t\tset_nulls(q.filters);\n\t\t\t\t\t}\n\n\t\t\t\t\t// turn off value translation\n\t\t\t\t\tif(q.translate_values !== undefined) {\n\t\t\t\t\t\tthis.translate_values = q.translate_values;\n\t\t\t\t\t}\n\n\t\t\t\t\t// extend args for custom functions\n\t\t\t\t\t$.extend(args, q);\n\n\t\t\t\t\t// add \"filters\" for standard query (search.py)\n\t\t\t\t\targs.filters = q.filters;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(this.df.filters) {\n\t\t\tset_nulls(this.df.filters);\n\t\t\tif(!args.filters) args.filters = {};\n\t\t\t$.extend(args.filters, this.df.filters);\n\t\t}\n\t},\n\tvalidate: function(value) {\n\t\t// validate the value just entered\n\t\tif(this.df.options==\"[Select]\" || this.df.ignore_link_validation) {\n\t\t\treturn value;\n\t\t}\n\n\t\treturn this.validate_link_and_fetch(this.df, this.get_options(),\n\t\t\tthis.docname, value);\n\t},\n\tvalidate_link_and_fetch: function(df, doctype, docname, value) {\n\t\tvar me = this;\n\n\t\tif(value) {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tvar fetch = '';\n\n\t\t\t\tif(this.frm && this.frm.fetch_dict[df.fieldname]) {\n\t\t\t\t\tfetch = this.frm.fetch_dict[df.fieldname].columns.join(', ');\n\t\t\t\t}\n\n\t\t\t\treturn frappe.call({\n\t\t\t\t\tmethod:'frappe.desk.form.utils.validate_link',\n\t\t\t\t\ttype: \"GET\",\n\t\t\t\t\targs: {\n\t\t\t\t\t\t'value': value,\n\t\t\t\t\t\t'options': doctype,\n\t\t\t\t\t\t'fetch': fetch\n\t\t\t\t\t},\n\t\t\t\t\tno_spinner: true,\n\t\t\t\t\tcallback: function(r) {\n\t\t\t\t\t\tif(r.message=='Ok') {\n\t\t\t\t\t\t\tif(r.fetch_values && docname) {\n\t\t\t\t\t\t\t\tme.set_fetch_values(df, docname, r.fetch_values);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve(r.valid_value);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(\"\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\tset_fetch_values: function(df, docname, fetch_values) {\n\t\tvar fl = this.frm.fetch_dict[df.fieldname].fields;\n\t\tfor(var i=0; i < fl.length; i++) {\n\t\t\tfrappe.model.set_value(df.parent, docname, fl[i], fetch_values[i], df.fieldtype);\n\t\t}\n\t}\n});\n\nif(Awesomplete) {\n\tAwesomplete.prototype.get_item = function(value) {\n\t\treturn this._list.find(function(item) {\n\t\t\treturn item.value === value;\n\t\t});\n\t};\n}\n\n","frappe.ui.form.ControlDynamicLink = frappe.ui.form.ControlLink.extend({\n\tget_options: function() {\n\t\tlet options = '';\n\t\tif(this.df.get_options) {\n\t\t\toptions = this.df.get_options();\n\t\t}\n\t\telse if (this.docname==null && cur_dialog) {\n\t\t\t//for dialog box\n\t\t\toptions = cur_dialog.get_value(this.df.options);\n\t\t}\n\t\telse if (!cur_frm) {\n\t\t\tconst selector = `input[data-fieldname=\"${this.df.options}\"]`;\n\t\t\tlet input = null;\n\t\t\tif (cur_list) {\n\t\t\t\t// for list page\n\t\t\t\tinput = cur_list.wrapper.find(selector);\n\t\t\t}\n\t\t\tif (cur_page) {\n\t\t\t\tinput = $(cur_page.page).find(selector);\n\t\t\t}\n\t\t\tif (input) {\n\t\t\t\toptions = input.val();\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\toptions = frappe.model.get_value(this.df.parent, this.docname, this.df.options);\n\t\t}\n\n\t\tif (frappe.model.is_single(options)) {\n\t\t\tfrappe.throw(__(`${options.bold()} is not a valid DocType for Dynamic Link`));\n\t\t}\n\n\t\treturn options;\n\t},\n});\n","frappe.ui.form.ControlText = frappe.ui.form.ControlData.extend({\n\thtml_element: \"textarea\",\n\thorizontal: false,\n\tmake_wrapper: function() {\n\t\tthis._super();\n\t\tthis.$wrapper.find(\".like-disabled-input\").addClass(\"for-description\");\n\t},\n\tmake_input: function() {\n\t\tthis._super();\n\t\tthis.$input.css({'height': '300px'});\n\t}\n});\n\nfrappe.ui.form.ControlLongText = frappe.ui.form.ControlText;\nfrappe.ui.form.ControlSmallText = frappe.ui.form.ControlText.extend({\n\tmake_input: function() {\n\t\tthis._super();\n\t\tthis.$input.css({'height': '150px'});\n\t}\n});\n","frappe.ui.form.ControlCode = frappe.ui.form.ControlText.extend({\n\tmake_input: function() {\n\t\tthis._super();\n\t\t$(this.input_area).find(\"textarea\")\n\t\t\t.allowTabs()\n\t\t\t.addClass('control-code');\n\t}\n});\n","frappe.ui.form.ControlTextEditor = frappe.ui.form.ControlCode.extend({\n\tmake_input: function() {\n\t\tthis.has_input = true;\n\t\tthis.make_editor();\n\t\tthis.hide_elements_on_mobile();\n\t\tthis.setup_drag_drop();\n\t\tthis.setup_image_dialog();\n\t\tthis.setting_count = 0;\n\n\t\t$(document).on('form-refresh', () => {\n\t\t\t// reset last keystroke when a new form is loaded\n\t\t\tthis.last_keystroke_on = null;\n\t\t})\n\t},\n\trender_camera_button: (context) => {\n\t\tvar ui     = $.summernote.ui;\n\t\tvar button = ui.button({\n\t\t\tcontents: '<i class=\"fa fa-camera\"/>',\n\t\t\ttooltip: 'Camera',\n\t\t\tclick: () => {\n\t\t\t\tconst capture = new frappe.ui.Capture();\n\t\t\t\tcapture.show();\n\n\t\t\t\tcapture.submit((data) => {\n\t\t\t\t\tcontext.invoke('editor.insertImage', data);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn button.render();\n\t},\n\tmake_editor: function() {\n\t\tvar me = this;\n\t\tthis.editor = $(\"<div>\").appendTo(this.input_area);\n\n\t\t// Note: while updating summernote, please make sure all 'p' blocks\n\t\t// in the summernote source code are replaced by 'div' blocks.\n\t\t// by default summernote, adds <p> blocks for new paragraphs, which adds\n\t\t// unexpected whitespaces, esp for email replies.\n\n\t\tthis.editor.summernote({\n\t\t\tminHeight: 400,\n\t\t\ttoolbar: [\n\t\t\t\t['magic', ['style']],\n\t\t\t\t['style', ['bold', 'italic', 'underline', 'clear']],\n\t\t\t\t['fontsize', ['fontsize']],\n\t\t\t\t['color', ['color']],\n\t\t\t\t['para', ['ul', 'ol', 'paragraph', 'hr']],\n\t\t\t\t//['height', ['height']],\n\t\t\t\t['media', ['link', 'picture', 'camera', 'video', 'table']],\n\t\t\t\t['misc', ['fullscreen', 'codeview']]\n\t\t\t],\n\t\t\tbuttons: {\n\t\t\t\tcamera: this.render_camera_button,\n\t\t\t},\n\t\t\tkeyMap: {\n\t\t\t\tpc: {\n\t\t\t\t\t'CTRL+ENTER': ''\n\t\t\t\t},\n\t\t\t\tmac: {\n\t\t\t\t\t'CMD+ENTER': ''\n\t\t\t\t}\n\t\t\t},\n\t\t\tprettifyHtml: true,\n\t\t\tdialogsInBody: true,\n\t\t\tcallbacks: {\n\t\t\t\tonInit: function() {\n\t\t\t\t\t// firefox hack that puts the caret in the wrong position\n\t\t\t\t\t// when div is empty. To fix, seed with a <br>.\n\t\t\t\t\t// See https://bugzilla.mozilla.org/show_bug.cgi?id=550434\n\t\t\t\t\t// this function is executed only once\n\t\t\t\t\t$(\".note-editable[contenteditable='true']\").one('focus', function() {\n\t\t\t\t\t\tvar $this = $(this);\n\t\t\t\t\t\tif(!$this.html())\n\t\t\t\t\t\t\t$this.html($this.html() + '<br>');\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonChange: function(value) {\n\t\t\t\t\tme.parse_validate_and_set_in_model(value);\n\t\t\t\t},\n\t\t\t\tonKeydown: function(e) {\n\t\t\t\t\tme.last_keystroke_on = new Date();\n\t\t\t\t\tvar key = frappe.ui.keys.get_key(e);\n\t\t\t\t\t// prevent 'New DocType (Ctrl + B)' shortcut in editor\n\t\t\t\t\tif(['ctrl+b', 'meta+b'].indexOf(key) !== -1) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tif(key.indexOf('escape') !== -1) {\n\t\t\t\t\t\tif(me.note_editor.hasClass('fullscreen')) {\n\t\t\t\t\t\t\t// exit fullscreen on escape key\n\t\t\t\t\t\t\tme.note_editor\n\t\t\t\t\t\t\t\t.find('.note-btn.btn-fullscreen')\n\t\t\t\t\t\t\t\t.trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\ticons: {\n\t\t\t\t'align': 'fa fa-align',\n\t\t\t\t'alignCenter': 'fa fa-align-center',\n\t\t\t\t'alignJustify': 'fa fa-align-justify',\n\t\t\t\t'alignLeft': 'fa fa-align-left',\n\t\t\t\t'alignRight': 'fa fa-align-right',\n\t\t\t\t'indent': 'fa fa-indent',\n\t\t\t\t'outdent': 'fa fa-outdent',\n\t\t\t\t'arrowsAlt': 'fa fa-arrows-alt',\n\t\t\t\t'bold': 'fa fa-bold',\n\t\t\t\t'camera': 'fa fa-camera',\n\t\t\t\t'caret': 'caret',\n\t\t\t\t'circle': 'fa fa-circle',\n\t\t\t\t'close': 'fa fa-close',\n\t\t\t\t'code': 'fa fa-code',\n\t\t\t\t'eraser': 'fa fa-eraser',\n\t\t\t\t'font': 'fa fa-font',\n\t\t\t\t'frame': 'fa fa-frame',\n\t\t\t\t'italic': 'fa fa-italic',\n\t\t\t\t'link': 'fa fa-link',\n\t\t\t\t'unlink': 'fa fa-chain-broken',\n\t\t\t\t'magic': 'fa fa-magic',\n\t\t\t\t'menuCheck': 'fa fa-check',\n\t\t\t\t'minus': 'fa fa-minus',\n\t\t\t\t'orderedlist': 'fa fa-list-ol',\n\t\t\t\t'pencil': 'fa fa-pencil',\n\t\t\t\t'picture': 'fa fa-image',\n\t\t\t\t'question': 'fa fa-question',\n\t\t\t\t'redo': 'fa fa-redo',\n\t\t\t\t'square': 'fa fa-square',\n\t\t\t\t'strikethrough': 'fa fa-strikethrough',\n\t\t\t\t'subscript': 'fa fa-subscript',\n\t\t\t\t'superscript': 'fa fa-superscript',\n\t\t\t\t'table': 'fa fa-table',\n\t\t\t\t'textHeight': 'fa fa-text-height',\n\t\t\t\t'trash': 'fa fa-trash',\n\t\t\t\t'underline': 'fa fa-underline',\n\t\t\t\t'undo': 'fa fa-undo',\n\t\t\t\t'unorderedlist': 'fa fa-list-ul',\n\t\t\t\t'video': 'fa fa-video-camera'\n\t\t\t}\n\t\t});\n\t\tthis.note_editor = $(this.input_area).find('.note-editor');\n\t\t// to fix <p> on enter\n\t\t//this.set_formatted_input('<div><br></div>');\n\t},\n\tsetup_drag_drop: function() {\n\t\tvar me = this;\n\t\tthis.note_editor.on('dragenter dragover', false)\n\t\t\t.on('drop', function(e) {\n\t\t\t\tvar dataTransfer = e.originalEvent.dataTransfer;\n\n\t\t\t\tif (dataTransfer && dataTransfer.files && dataTransfer.files.length) {\n\t\t\t\t\tme.note_editor.focus();\n\n\t\t\t\t\tvar files = [].slice.call(dataTransfer.files);\n\n\t\t\t\t\tfiles.forEach(file => {\n\t\t\t\t\t\tme.get_image(file, (url) => {\n\t\t\t\t\t\t\tme.editor.summernote('insertImage', url, file.name);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t},\n\tget_image: function (fileobj, callback) {\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function() {\n\t\t\tvar dataurl = reader.result;\n\t\t\t// add filename to dataurl\n\t\t\tvar parts = dataurl.split(\",\");\n\t\t\tparts[0] += \";filename=\" + fileobj.name;\n\t\t\tdataurl = parts[0] + ',' + parts[1];\n\t\t\tcallback(dataurl);\n\t\t};\n\t\treader.readAsDataURL(fileobj);\n\t},\n\thide_elements_on_mobile: function() {\n\t\tthis.note_editor.find('.note-btn-underline,\\\n\t\t\t.note-btn-italic, .note-fontsize,\\\n\t\t\t.note-color, .note-height, .btn-codeview')\n\t\t\t.addClass('hidden-xs');\n\t\tif($('.toggle-sidebar').is(':visible')) {\n\t\t\t// disable tooltips on mobile\n\t\t\tthis.note_editor.find('.note-btn')\n\t\t\t\t.attr('data-original-title', '');\n\t\t}\n\t},\n\tget_input_value: function() {\n\t\treturn this.editor? this.editor.summernote('code'): '';\n\t},\n\tparse: function(value) {\n\t\tif(value == null) value = \"\";\n\t\treturn frappe.dom.remove_script_and_style(value);\n\t},\n\tset_formatted_input: function(value) {\n\t\tif(value !== this.get_input_value()) {\n\t\t\tthis.set_in_editor(value);\n\t\t}\n\t},\n\tset_in_editor: function(value) {\n\t\t// set values in editor only if\n\t\t// 1. value not be set in the last 500ms\n\t\t// 2. user has not typed anything in the last 3seconds\n\t\t// ---\n\t\t// we will attempt to cleanup the user's DOM, hence if this happens\n\t\t// in the middle of the user is typing, it creates a lot of issues\n\t\t// also firefox tends to reset the cursor for some reason if the values\n\t\t// are reset\n\n\t\tif(this.setting_count > 2) {\n\t\t\t// we don't understand how the internal triggers work,\n\t\t\t// so if someone is setting the value third time in 500ms,\n\t\t\t// then quit\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setting_count += 1;\n\n\t\tlet time_since_last_keystroke = moment() - moment(this.last_keystroke_on);\n\n\t\tif(!this.last_keystroke_on || (time_since_last_keystroke > 3000)) {\n\t\t\t// if 3 seconds have passed since the last keystroke and\n\t\t\t// we have not set any value in the last 1 second, do this\n\t\t\tsetTimeout(() => this.setting_count = 0, 500);\n\t\t\tthis.editor.summernote('code', value || '');\n\t\t\tthis.last_keystroke_on = null;\n\t\t} else {\n\t\t\t// user is probably still in the middle of typing\n\t\t\t// so lets not mess up the html by re-updating it\n\t\t\t// keep checking every second if our 3 second barrier\n\t\t\t// has been completed, so that we can refresh the html\n\t\t\tthis._setting_value = setInterval(() => {\n\t\t\t\tif(time_since_last_keystroke > 3000) {\n\t\t\t\t\t// 3 seconds done! lets refresh\n\t\t\t\t\t// safe to update\n\t\t\t\t\tif(this.last_value !== this.get_input_value()) {\n\t\t\t\t\t\t// if not already in sync, reset\n\t\t\t\t\t\tthis.editor.summernote('code', this.last_value || '');\n\t\t\t\t\t}\n\t\t\t\t\tclearInterval(this._setting_value);\n\t\t\t\t\tthis._setting_value = null;\n\t\t\t\t\tthis.setting_count = 0;\n\n\t\t\t\t\t// clear timestamp of last keystroke\n\t\t\t\t\tthis.last_keystroke_on = null;\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\t},\n\tset_focus: function() {\n\t\treturn this.editor.summernote('focus');\n\t},\n\tset_upload_options: function() {\n\t\tvar me = this;\n\t\tthis.upload_options = {\n\t\t\tparent: this.image_dialog.get_field(\"upload_area\").$wrapper,\n\t\t\targs: {},\n\t\t\tmax_width: this.df.max_width,\n\t\t\tmax_height: this.df.max_height,\n\t\t\toptions: \"Image\",\n\t\t\tno_socketio: true,\n\t\t\tbtn: this.image_dialog.set_primary_action(__(\"Insert\")),\n\t\t\ton_no_attach: function() {\n\t\t\t\t// if no attachmemts,\n\t\t\t\t// check if something is selected\n\t\t\t\tvar selected = me.image_dialog.get_field(\"select\").get_value();\n\t\t\t\tif(selected) {\n\t\t\t\t\tme.editor.summernote('insertImage', selected);\n\t\t\t\t\tme.image_dialog.hide();\n\t\t\t\t} else {\n\t\t\t\t\tfrappe.msgprint(__(\"Please attach a file or set a URL\"));\n\t\t\t\t}\n\t\t\t},\n\t\t\tcallback: function(attachment) {\n\t\t\t\tme.editor.summernote('insertImage', attachment.file_url, attachment.file_name);\n\t\t\t\tme.image_dialog.hide();\n\t\t\t},\n\t\t\tonerror: function() {\n\t\t\t\tme.image_dialog.hide();\n\t\t\t}\n\t\t};\n\n\t\tif (\"is_private\" in this.df) {\n\t\t\tthis.upload_options.is_private = this.df.is_private;\n\t\t}\n\n\t\tif(this.frm) {\n\t\t\tthis.upload_options.args = {\n\t\t\t\tfrom_form: 1,\n\t\t\t\tdoctype: this.frm.doctype,\n\t\t\t\tdocname: this.frm.docname\n\t\t\t};\n\t\t} else {\n\t\t\tthis.upload_options.on_attach = function(fileobj, dataurl) {\n\t\t\t\tme.editor.summernote('insertImage', dataurl);\n\t\t\t\tme.image_dialog.hide();\n\t\t\t\tfrappe.hide_progress();\n\t\t\t};\n\t\t}\n\t},\n\n\tsetup_image_dialog: function() {\n\t\tthis.note_editor.find('[data-original-title=\"Image\"]').on('click', () => {\n\t\t\tif(!this.image_dialog) {\n\t\t\t\tthis.image_dialog = new frappe.ui.Dialog({\n\t\t\t\t\ttitle: __(\"Image\"),\n\t\t\t\t\tfields: [\n\t\t\t\t\t\t{fieldtype:\"HTML\", fieldname:\"upload_area\"},\n\t\t\t\t\t\t{fieldtype:\"HTML\", fieldname:\"or_attach\", options: __(\"Or\")},\n\t\t\t\t\t\t{fieldtype:\"Select\", fieldname:\"select\", label:__(\"Select from existing attachments\") },\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.image_dialog.show();\n\t\t\tthis.image_dialog.get_field(\"upload_area\").$wrapper.empty();\n\n\t\t\t// select from existing attachments\n\t\t\tvar attachments = this.frm && this.frm.attachments.get_attachments() || [];\n\t\t\tvar select = this.image_dialog.get_field(\"select\");\n\t\t\tif(attachments.length) {\n\t\t\t\tattachments = $.map(attachments, function(o) { return o.file_url; });\n\t\t\t\tselect.df.options = [\"\"].concat(attachments);\n\t\t\t\tselect.toggle(true);\n\t\t\t\tthis.image_dialog.get_field(\"or_attach\").toggle(true);\n\t\t\t\tselect.refresh();\n\t\t\t} else {\n\t\t\t\tthis.image_dialog.get_field(\"or_attach\").toggle(false);\n\t\t\t\tselect.toggle(false);\n\t\t\t}\n\t\t\tselect.$input.val(\"\");\n\n\t\t\tthis.set_upload_options();\n\t\t\tfrappe.upload.make(this.upload_options);\n\t\t});\n\t}\n});\n","frappe.ui.form.ControlCheck = frappe.ui.form.ControlData.extend({\n\tinput_type: \"checkbox\",\n\tmake_wrapper: function() {\n\t\tthis.$wrapper = $('<div class=\"form-group frappe-control\">\\\n\t\t\t<div class=\"checkbox\">\\\n\t\t\t\t<label>\\\n\t\t\t\t\t<span class=\"input-area\"></span>\\\n\t\t\t\t\t<span class=\"disp-area\"></span>\\\n\t\t\t\t\t<span class=\"label-area small\"></span>\\\n\t\t\t\t</label>\\\n\t\t\t\t<p class=\"help-box small text-muted\"></p>\\\n\t\t\t</div>\\\n\t\t</div>').appendTo(this.parent);\n\t},\n\tset_input_areas: function() {\n\t\tthis.label_area = this.label_span = this.$wrapper.find(\".label-area\").get(0);\n\t\tthis.input_area = this.$wrapper.find(\".input-area\").get(0);\n\t\tthis.disp_area = this.$wrapper.find(\".disp-area\").get(0);\n\t},\n\tmake_input: function() {\n\t\tthis._super();\n\t\tthis.$input.removeClass(\"form-control\");\n\t},\n\tget_input_value: function() {\n\t\treturn this.input && this.input.checked ? 1 : 0;\n\t},\n\tvalidate: function(value) {\n\t\treturn cint(value);\n\t},\n\tset_input: function(value) {\n\t\tif(this.input) {\n\t\t\tthis.input.checked = (value ? 1 : 0);\n\t\t}\n\t\tthis.last_value = value;\n\t\tthis.set_mandatory(value);\n\t\tthis.set_disp_area(value);\n\t}\n});\n","frappe.ui.form.ControlImage = frappe.ui.form.Control.extend({\n\tmake: function() {\n\t\tthis._super();\n\t\tthis.$wrapper.css({\"margin\": \"0px\"});\n\t\tthis.$body = $(\"<div></div>\").appendTo(this.$wrapper)\n\t\t\t.css({\"margin-bottom\": \"10px\"});\n\t\t$('<div class=\"clearfix\"></div>').appendTo(this.$wrapper);\n\t},\n\trefresh_input: function() {\n\t\tthis.$body.empty();\n\n\t\tvar doc = this.get_doc();\n\t\tif(doc && this.df.options && doc[this.df.options]) {\n\t\t\tthis.$img = $(\"<img src='\"+doc[this.df.options]+\"' class='img-responsive'>\")\n\t\t\t\t.appendTo(this.$body);\n\t\t} else {\n\t\t\tthis.$buffer = $(\"<div class='missing-image'><i class='octicon octicon-circle-slash'></i></div>\")\n\t\t\t\t.appendTo(this.$body);\n\t\t}\n\t\treturn false;\n\t}\n});\n","frappe.ui.form.ControlAttach = frappe.ui.form.ControlData.extend({\n\tmake_input: function() {\n\t\tvar me = this;\n\t\tthis.$input = $('<button class=\"btn btn-default btn-sm btn-attach\">')\n\t\t\t.html(__(\"Attach\"))\n\t\t\t.prependTo(me.input_area)\n\t\t\t.on(\"click\", function() {\n\t\t\t\tme.onclick();\n\t\t\t});\n\t\tthis.$value = $(\n\t\t\t`<div class=\"attached-file\">\n\t\t\t\t<div class=\"ellipsis\">\n\t\t\t\t\t<i class=\"fa fa-paperclip\"></i>\n\t\t\t\t\t<a class=\"attached-file-link\" target=\"_blank\"></a>\n\t\t\t\t</div>\n\t\t\t\t<a class=\"close\">&times;</a>\n\t\t\t</div>`)\n\t\t\t.prependTo(me.input_area)\n\t\t\t.toggle(false);\n\t\tthis.input = this.$input.get(0);\n\t\tthis.set_input_attributes();\n\t\tthis.has_input = true;\n\n\t\tthis.$value.find(\".close\").on(\"click\", function() {\n\t\t\tme.clear_attachment();\n\t\t});\n\t},\n\tclear_attachment: function() {\n\t\tvar me = this;\n\t\tif(this.frm) {\n\t\t\tme.frm.attachments.remove_attachment_by_filename(me.value, function() {\n\t\t\t\tme.parse_validate_and_set_in_model(null);\n\t\t\t\tme.refresh();\n\t\t\t\tme.frm.doc.docstatus == 1 ? me.frm.save('Update') : me.frm.save();\n\t\t\t});\n\t\t} else {\n\t\t\tthis.dataurl = null;\n\t\t\tthis.fileobj = null;\n\t\t\tthis.set_input(null);\n\t\t\tthis.refresh();\n\t\t}\n\t},\n\tonclick: function() {\n\t\tvar me = this;\n\t\tif(this.doc) {\n\t\t\tvar doc = this.doc.parent && frappe.model.get_doc(this.doc.parenttype, this.doc.parent) || this.doc;\n\t\t\tif (doc.__islocal) {\n\t\t\t\tfrappe.msgprint(__(\"Please save the document before uploading.\"));\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif(!this.dialog) {\n\t\t\tthis.dialog = new frappe.ui.Dialog({\n\t\t\t\ttitle: __(this.df.label || __(\"Upload\")),\n\t\t\t\tfields: [\n\t\t\t\t\t{fieldtype:\"HTML\", fieldname:\"upload_area\"},\n\t\t\t\t\t{fieldtype:\"HTML\", fieldname:\"or_attach\", options: __(\"Or\")},\n\t\t\t\t\t{fieldtype:\"Select\", fieldname:\"select\", label:__(\"Select from existing attachments\") },\n\t\t\t\t\t{fieldtype:\"Button\", fieldname:\"clear\",\n\t\t\t\t\t\tlabel:__(\"Clear Attachment\"), click: function() {\n\t\t\t\t\t\t\tme.clear_attachment();\n\t\t\t\t\t\t\tme.dialog.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\n\t\tthis.dialog.show();\n\n\t\tthis.dialog.get_field(\"upload_area\").$wrapper.empty();\n\n\t\t// select from existing attachments\n\t\tvar attachments = this.frm && this.frm.attachments.get_attachments() || [];\n\t\tvar select = this.dialog.get_field(\"select\");\n\t\tif(attachments.length) {\n\t\t\tattachments = $.map(attachments, function(o) { return o.file_url; });\n\t\t\tselect.df.options = [\"\"].concat(attachments);\n\t\t\tselect.toggle(true);\n\t\t\tthis.dialog.get_field(\"or_attach\").toggle(true);\n\t\t\tselect.refresh();\n\t\t} else {\n\t\t\tthis.dialog.get_field(\"or_attach\").toggle(false);\n\t\t\tselect.toggle(false);\n\t\t}\n\t\tselect.$input.val(\"\");\n\n\t\t// show button if attachment exists\n\t\tthis.dialog.get_field('clear').$wrapper.toggle(this.get_model_value() ? true : false);\n\n\t\tthis.set_upload_options();\n\t\tfrappe.upload.make(this.upload_options);\n\t},\n\n\tset_upload_options: function() {\n\t\tvar me = this;\n\t\tthis.upload_options = {\n\t\t\tparent: this.dialog.get_field(\"upload_area\").$wrapper,\n\t\t\targs: {},\n\t\t\tallow_multiple: 0,\n\t\t\tmax_width: this.df.max_width,\n\t\t\tmax_height: this.df.max_height,\n\t\t\toptions: this.df.options,\n\t\t\tbtn: this.dialog.set_primary_action(__(\"Upload\")),\n\t\t\ton_no_attach: function() {\n\t\t\t\t// if no attachmemts,\n\t\t\t\t// check if something is selected\n\t\t\t\tvar selected = me.dialog.get_field(\"select\").get_value();\n\t\t\t\tif(selected) {\n\t\t\t\t\tme.parse_validate_and_set_in_model(selected);\n\t\t\t\t\tme.dialog.hide();\n\t\t\t\t\tme.frm.save();\n\t\t\t\t} else {\n\t\t\t\t\tfrappe.msgprint(__(\"Please attach a file or set a URL\"));\n\t\t\t\t}\n\t\t\t},\n\t\t\tcallback: function(attachment) {\n\t\t\t\tme.on_upload_complete(attachment);\n\t\t\t\tme.dialog.hide();\n\t\t\t},\n\t\t\tonerror: function() {\n\t\t\t\tme.dialog.hide();\n\t\t\t}\n\t\t};\n\n\t\tif (\"is_private\" in this.df) {\n\t\t\tthis.upload_options.is_private = this.df.is_private;\n\t\t}\n\n\t\tif(this.frm) {\n\t\t\tthis.upload_options.args = {\n\t\t\t\tfrom_form: 1,\n\t\t\t\tdoctype: this.frm.doctype,\n\t\t\t\tdocname: this.frm.docname\n\t\t\t};\n\t\t} else {\n\t\t\tthis.upload_options.on_attach = function(fileobj, dataurl) {\n\t\t\t\tme.dialog.hide();\n\t\t\t\tme.fileobj = fileobj;\n\t\t\t\tme.dataurl = dataurl;\n\t\t\t\tif(me.on_attach) {\n\t\t\t\t\tme.on_attach();\n\t\t\t\t}\n\t\t\t\tif(me.df.on_attach) {\n\t\t\t\t\tme.df.on_attach(fileobj, dataurl);\n\t\t\t\t}\n\t\t\t\tme.on_upload_complete();\n\t\t\t};\n\t\t}\n\t},\n\n\tset_input: function(value, dataurl) {\n\t\tthis.value = value;\n\t\tif(this.value) {\n\t\t\tthis.$input.toggle(false);\n\t\t\tif(this.value.indexOf(\",\")!==-1) {\n\t\t\t\tvar parts = this.value.split(\",\");\n\t\t\t\tvar filename = parts[0];\n\t\t\t\tdataurl = parts[1];\n\t\t\t}\n\t\t\tthis.$value.toggle(true).find(\".attached-file-link\")\n\t\t\t\t.html(filename || this.value)\n\t\t\t\t.attr(\"href\", dataurl || this.value);\n\t\t} else {\n\t\t\tthis.$input.toggle(true);\n\t\t\tthis.$value.toggle(false);\n\t\t}\n\t},\n\n\tget_value: function() {\n\t\tif(this.frm) {\n\t\t\treturn this.value;\n\t\t} else {\n\t\t\tif ( this.fileobj ) {\n\t\t\t\tif ( this.fileobj.file_url ) {\n\t\t\t\t\treturn this.fileobj.file_url;\n\t\t\t\t} else if ( this.fileobj.filename ) {\n\t\t\t\t\tvar dataURI = this.fileobj.filename + ',' + this.dataurl;\n\n\t\t\t\t\treturn dataURI;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t},\n\n\ton_upload_complete: function(attachment) {\n\t\tif(this.frm) {\n\t\t\tthis.parse_validate_and_set_in_model(attachment.file_url);\n\t\t\tthis.refresh();\n\t\t\tthis.frm.attachments.update_attachment(attachment);\n\t\t\tthis.frm.doc.docstatus == 1 ? this.frm.save('Update') : this.frm.save();\n\t\t} else {\n\t\t\tthis.value = this.get_value();\n\t\t\tthis.refresh();\n\t\t\tfrappe.hide_progress();\n\t\t}\n\t},\n});\n","frappe.ui.form.ControlAttachImage = frappe.ui.form.ControlAttach.extend({\n\tmake: function() {\n\t\tvar me = this;\n\t\tthis._super();\n\n\t\tthis.container = $('<div class=\"control-container\">').insertAfter($(this.wrapper));\n\t\t$(this.wrapper).detach();\n\t\tthis.container.attr('data-fieldtype', this.df.fieldtype).append(this.wrapper);\n\t\tif(this.df.align === 'center') {\n\t\t\tthis.container.addClass(\"flex-justify-center\");\n\t\t} else if (this.df.align === 'right') {\n\t\t\tthis.container.addClass(\"flex-justify-end\");\n\t\t}\n\n\t\tthis.img_wrapper = $('<div style=\"width: 100%; height: calc(100% - 40px); position: relative;\">\\\n\t\t\t<div class=\"missing-image attach-missing-image\"><i class=\"octicon octicon-device-camera\"></i></div></div>')\n\t\t\t.appendTo(this.wrapper);\n\n\t\tthis.img_container = $(`<div class='img-container'></div>`);\n\t\tthis.img = $(`<img class='img-responsive attach-image-display'>`)\n\t\t\t.appendTo(this.img_container);\n\n\t\tthis.img_overlay = $(`<div class='img-overlay'>\n\t\t\t\t<span class=\"overlay-text\">Change</span>\n\t\t\t</div>`).appendTo(this.img_container);\n\n\t\tthis.remove_image_link = $('<a style=\"font-size: 12px;color: #8D99A6;\">Remove</a>');\n\n\t\tthis.img_wrapper.append(this.img_container).append(this.remove_image_link);\n\t\t// this.img.toggle(false);\n\t\t// this.img_overlay.toggle(false);\n\t\tthis.img_container.toggle(false);\n\t\tthis.remove_image_link.toggle(false);\n\n\t\t// propagate click to Attach button\n\t\tthis.img_wrapper.find(\".missing-image\").on(\"click\", function() { me.$input.click(); });\n\t\tthis.img_container.on(\"click\", function() { me.$input.click(); });\n\t\tthis.remove_image_link.on(\"click\", function() { me.$value.find(\".close\").click(); });\n\n\t\tthis.set_image();\n\t},\n\trefresh_input: function() {\n\t\tthis._super();\n\t\t$(this.wrapper).find('.btn-attach').addClass('hidden');\n\t\tthis.set_image();\n\t\tif(this.get_status()==\"Read\") {\n\t\t\t$(this.disp_area).toggle(false);\n\t\t}\n\t},\n\tset_image: function() {\n\t\tif(this.get_value()) {\n\t\t\t$(this.img_wrapper).find(\".missing-image\").toggle(false);\n\t\t\t// this.img.attr(\"src\", this.dataurl ? this.dataurl : this.value).toggle(true);\n\t\t\t// this.img_overlay.toggle(true);\n\t\t\tthis.img.attr(\"src\", this.dataurl ? this.dataurl : this.value);\n\t\t\tthis.img_container.toggle(true);\n\t\t\tthis.remove_image_link.toggle(true);\n\t\t} else {\n\t\t\t$(this.img_wrapper).find(\".missing-image\").toggle(true);\n\t\t\t// this.img.toggle(false);\n\t\t\t// this.img_overlay.toggle(false);\n\t\t\tthis.img_container.toggle(false);\n\t\t\tthis.remove_image_link.toggle(false);\n\t\t}\n\t}\n});\n","frappe.ui.form.ControlTable = frappe.ui.form.Control.extend({\n\tmake: function() {\n\t\tthis._super();\n\n\t\t// add title if prev field is not column / section heading or html\n\t\tthis.grid = new frappe.ui.form.Grid({\n\t\t\tfrm: this.frm,\n\t\t\tdf: this.df,\n\t\t\tperm: this.perm || (this.frm && this.frm.perm) || this.df.perm,\n\t\t\tparent: this.wrapper\n\t\t});\n\t\tif(this.frm) {\n\t\t\tthis.frm.grids[this.frm.grids.length] = this;\n\t\t}\n\n\t\t// description\n\t\tif(this.df.description) {\n\t\t\t$('<p class=\"text-muted small\">' + __(this.df.description) + '</p>')\n\t\t\t\t.appendTo(this.wrapper);\n\t\t}\n\t},\n\trefresh_input: function() {\n\t\tthis.grid.refresh();\n\t},\n\tget_value: function() {\n\t\tif(this.grid) {\n\t\t\treturn this.grid.get_data();\n\t\t}\n\t}\n});\n","frappe.ui.form.ControlColor = frappe.ui.form.ControlData.extend({\n\tmake_input: function () {\n\t\tthis._super();\n\t\tthis.colors = [\n\t\t\t\"#ffc4c4\", \"#ff8989\", \"#ff4d4d\", \"#a83333\",\n\t\t\t\"#ffe8cd\", \"#ffd19c\", \"#ffb868\", \"#a87945\",\n\t\t\t\"#ffd2c2\", \"#ffa685\", \"#ff7846\", \"#a85b5b\",\n\t\t\t\"#ffd7d7\", \"#ffb1b1\", \"#ff8989\", \"#a84f2e\",\n\t\t\t\"#fffacd\", \"#fff168\", \"#fff69c\", \"#a89f45\",\n\t\t\t\"#ebf8cc\", \"#d9f399\", \"#c5ec63\", \"#7b933d\",\n\t\t\t\"#cef6d1\", \"#9deca2\", \"#6be273\", \"#428b46\",\n\t\t\t\"#d2f8ed\", \"#a4f3dd\", \"#77ecca\", \"#49937e\",\n\t\t\t\"#d2f1ff\", \"#a6e4ff\", \"#78d6ff\", \"#4f8ea8\",\n\t\t\t\"#d2d2ff\", \"#a3a3ff\", \"#7575ff\", \"#4d4da8\",\n\t\t\t\"#dac7ff\", \"#b592ff\", \"#8e58ff\", \"#5e3aa8\",\n\t\t\t\"#f8d4f8\", \"#f3aaf0\", \"#ec7dea\", \"#934f92\"\n\t\t];\n\t\tthis.make_color_input();\n\t},\n\tmake_color_input: function () {\n\t\tthis.$wrapper\n\t\t\t.find('.control-input-wrapper')\n\t\t\t.append(`<div class=\"color-picker\">\n\t\t\t\t<div class=\"color-picker-pallete\"></div>\n\t\t\t</div>`);\n\t\tthis.$color_pallete = this.$wrapper.find('.color-picker-pallete');\n\n\t\tvar color_html = this.colors.map(this.get_color_box).join(\"\");\n\t\tthis.$color_pallete.append(color_html);\n\t\tthis.$color_pallete.hide();\n\t\tthis.bind_events();\n\t},\n\tget_color_box: function (hex) {\n\t\treturn `<div class=\"color-box\" data-color=\"${hex}\" style=\"background-color: ${hex}\"></div>`;\n\t},\n\tset_formatted_input: function(value) {\n\t\tthis._super(value);\n\n\t\tif (!value) value = '#FFFFFF';\n\t\tconst contrast    = frappe.ui.color.get_contrast_color(value);\n\n\t\tthis.$input.css({\n\t\t\t\"background-color\": value, \"color\": contrast\n\t\t});\n\t},\n\tbind_events: function () {\n\t\tvar mousedown_happened = false;\n\t\tthis.$wrapper.on(\"click\", \".color-box\", (e) => {\n\t\t\tmousedown_happened = false;\n\n\t\t\tvar color_val = $(e.target).data(\"color\");\n\t\t\tthis.set_value(color_val);\n\t\t\t// set focus so that we can blur it later\n\t\t\tthis.set_focus();\n\t\t});\n\n\t\tthis.$wrapper.find(\".color-box\").mousedown(() => {\n\t\t\tmousedown_happened = true;\n\t\t});\n\n\t\tthis.$input.on(\"focus\", () => {\n\t\t\tthis.$color_pallete.show();\n\t\t});\n\t\tthis.$input.on(\"blur\", () => {\n\t\t\tif (mousedown_happened) {\n\t\t\t\t// cancel the blur event\n\t\t\t\tmousedown_happened = false;\n\t\t\t} else {\n\t\t\t\t// blur event is okay\n\t\t\t\t$(this.$color_pallete).hide();\n\t\t\t}\n\t\t});\n\t},\n\tvalidate: function (value) {\n\t\tif(value === '') {\n\t\t\treturn '';\n\t\t}\n\t\tvar is_valid = /^#[0-9A-F]{6}$/i.test(value);\n\t\tif(is_valid) {\n\t\t\treturn value;\n\t\t}\n\t\treturn null;\n\t}\n});\n","frappe.ui.form.ControlSignature = frappe.ui.form.ControlData.extend({\n\tsaving: false,\n\tloading: false,\n\tmake: function() {\n\t\tvar me = this;\n\t\tthis._super();\n\n\t\t// make jSignature field\n\t\tthis.body = $('<div class=\"signature-field\"></div>').appendTo(me.wrapper);\n\t\tthis.make_pad();\n\n\t\tthis.img_wrapper = $(`<div class=\"signature-display\">\n\t\t\t<div class=\"missing-image attach-missing-image\">\n\t\t\t\t<i class=\"octicon octicon-circle-slash\"></i>\n\t\t\t</div></div>`)\n\t\t\t.appendTo(this.wrapper);\n\t\tthis.img = $(\"<img class='img-responsive attach-image-display'>\")\n\t\t\t.appendTo(this.img_wrapper).toggle(false);\n\n\t},\n\tmake_pad: function() {\n\t\tlet width = this.body.width();\n\t\tif (width > 0 && !this.$pad) {\n\t\t\tthis.$pad = this.body.jSignature({\n\t\t\t\theight: 300,\n\t\t\t\twidth: this.body.width(),\n\t\t\t\tlineWidth: 0.8\n\t\t\t}).on('change',\n\t\t\t\tthis.on_save_sign.bind(this));\n\t\t\tthis.load_pad();\n\t\t\tthis.$reset_button_wrapper = $(`<div class=\"signature-btn-row\">\n\t\t\t\t<a href=\"#\" type=\"button\" class=\"signature-reset btn btn-default\">\n\t\t\t\t<i class=\"glyphicon glyphicon-repeat\"></i></a>`)\n\t\t\t\t.appendTo(this.$pad)\n\t\t\t\t.on(\"click\", '.signature-reset', () => {\n\t\t\t\t\tthis.on_reset_sign();\n\t\t\t\t\treturn false;\n\t\t\t\t});\n\n\t\t}\n\t},\n\trefresh_input: function(e) {\n\t\t// prevent to load the second time\n\t\tthis.make_pad();\n\t\tthis.$wrapper.find(\".control-input\").toggle(false);\n\t\tthis.set_editable(this.get_status()==\"Write\");\n\t\tthis.load_pad();\n\t\tif(this.get_status()==\"Read\") {\n\t\t\t$(this.disp_area).toggle(false);\n\t\t}\n\t},\n\tset_image: function(value) {\n\t\tif(value) {\n\t\t\t$(this.img_wrapper).find(\".missing-image\").toggle(false);\n\t\t\tthis.img.attr(\"src\", value).toggle(true);\n\t\t} else {\n\t\t\t$(this.img_wrapper).find(\".missing-image\").toggle(true);\n\t\t\tthis.img.toggle(false);\n\t\t}\n\t},\n\tload_pad: function() {\n\t\t// make sure not triggered during saving\n\t\tif (this.saving) return;\n\t\t// get value\n\t\tvar value = this.get_value();\n\t\t// import data for pad\n\t\tif (this.$pad) {\n\t\t\tthis.loading = true;\n\t\t\t// reset in all cases\n\t\t\tthis.$pad.jSignature('reset');\n\t\t\tif (value) {\n\t\t\t\t// load the image to find out the size, because scaling will affect\n\t\t\t\t// stroke width\n\t\t\t\ttry {\n\t\t\t\t\tthis.$pad.jSignature('setData', value);\n\t\t\t\t\tthis.set_image(value);\n\t\t\t\t}\n\t\t\t\tcatch (e){\n\t\t\t\t\tconsole.log(\"Cannot set data for signature\", value, e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.loading = false;\n\t\t}\n\t},\n\tset_editable: function(editable) {\n\t\tthis.$pad && this.$pad.toggle(editable);\n\t\tthis.img_wrapper.toggle(!editable);\n\t\tif (this.$reset_button_wrapper) {\n\t\t\tthis.$reset_button_wrapper.toggle(editable);\n\t\t\tif (editable) {\n\t\t\t\tthis.$reset_button_wrapper.addClass('editing');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$reset_button_wrapper.removeClass('editing');\n\t\t\t}\n\t\t}\n\t},\n\tset_my_value: function(value) {\n\t\tif (this.saving || this.loading) return;\n\t\tthis.saving = true;\n\t\tthis.set_value(value);\n\t\tthis.saving = false;\n\t},\n\tget_value: function() {\n\t\treturn this.value ? this.value: this.get_model_value();\n\t},\n\t// reset signature canvas\n\ton_reset_sign: function() {\n\t\tthis.$pad.jSignature(\"reset\");\n\t\tthis.set_my_value(\"\");\n\t},\n\t// save signature value to model and display\n\ton_save_sign: function() {\n\t\tif (this.saving || this.loading) return;\n\t\tvar base64_img = this.$pad.jSignature(\"getData\");\n\t\tthis.set_my_value(base64_img);\n\t\tthis.set_image(this.get_value());\n\t}\n});","frappe.ui.form.ControlPassword = frappe.ui.form.ControlData.extend({\n\tinput_type: \"password\",\n\tmake: function() {\n\t\tthis._super();\n\t},\n\tmake_input: function() {\n\t\tvar me = this;\n\t\tthis._super();\n\t\tthis.$input.parent().append($('<span class=\"password-strength-indicator indicator\"></span>'));\n\t\tthis.$wrapper.find('.control-input-wrapper').append($('<p class=\"password-strength-message text-muted small hidden\"></p>'));\n\n\t\tthis.indicator = this.$wrapper.find('.password-strength-indicator');\n\t\tthis.message = this.$wrapper.find('.help-box');\n\n\t\tthis.$input.on('keyup', () => {\n\t\t\tclearTimeout(this.check_password_timeout);\n\t\t\tthis.check_password_timeout = setTimeout (() => {\n\t\t\t\tme.get_password_strength(me.$input.val());\n\t\t\t}, 500);\n\t\t});\n\t},\n\tget_password_strength: function(value) {\n\t\tvar me = this;\n\t\tfrappe.call({\n\t\t\ttype: 'POST',\n\t\t\tmethod: 'frappe.core.doctype.user.user.test_password_strength',\n\t\t\targs: {\n\t\t\t\tnew_password: value || ''\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif (r.message && r.message.entropy) {\n\t\t\t\t\tvar score = r.message.score,\n\t\t\t\t\t\tfeedback = r.message.feedback;\n\n\t\t\t\t\tfeedback.crack_time_display = r.message.crack_time_display;\n\n\t\t\t\t\tvar indicators = ['grey', 'red', 'orange', 'yellow', 'green'];\n\t\t\t\t\tme.set_strength_indicator(indicators[score]);\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\t},\n\tset_strength_indicator: function(color) {\n\t\tvar message = __(\"Include symbols, numbers and capital letters in the password\");\n\t\tthis.indicator.removeClass().addClass('password-strength-indicator indicator ' + color);\n\t\tthis.message.html(message).removeClass('hidden');\n\t}\n});\n","frappe.ui.form.ControlReadOnly = frappe.ui.form.ControlData.extend({\n\tget_status: function(explain) {\n\t\tvar status = this._super(explain);\n\t\tif(status===\"Write\")\n\t\t\tstatus = \"Read\";\n\t\treturn;\n\t},\n});\n","frappe.ui.form.ControlButton = frappe.ui.form.ControlData.extend({\n\tmake_input: function() {\n\t\tvar me = this;\n\t\tthis.$input = $('<button class=\"btn btn-default btn-xs\">')\n\t\t\t.prependTo(me.input_area)\n\t\t\t.on(\"click\", function() {\n\t\t\t\tme.onclick();\n\t\t\t});\n\t\tthis.input = this.$input.get(0);\n\t\tthis.set_input_attributes();\n\t\tthis.has_input = true;\n\t\tthis.toggle_label(false);\n\t},\n\tonclick: function() {\n\t\tif(this.frm && this.frm.doc) {\n\t\t\tif(this.frm.script_manager.has_handlers(this.df.fieldname, this.doctype)) {\n\t\t\t\tthis.frm.script_manager.trigger(this.df.fieldname, this.doctype, this.docname);\n\t\t\t} else {\n\t\t\t\tthis.frm.runscript(this.df.options, this);\n\t\t\t}\n\t\t}\n\t\telse if(this.df.click) {\n\t\t\tthis.df.click();\n\t\t}\n\t},\n\thide() {\n\t\tthis.$input.hide();\n\t},\n\tset_input_areas: function() {\n\t\tthis._super();\n\t\t$(this.disp_area).removeClass().addClass(\"hide\");\n\t},\n\tset_empty_description: function() {\n\t\tthis.$wrapper.find(\".help-box\").empty().toggle(false);\n\t},\n\tset_label: function() {\n\t\t$(this.label_span).html(\"&nbsp;\");\n\t\tthis.$input && this.$input.html((this.df.icon ?\n\t\t\t('<i class=\"'+this.df.icon+' fa-fw\"></i> ') : \"\") + __(this.df.label));\n\t}\n});\n","frappe.ui.form.ControlHTML = frappe.ui.form.Control.extend({\n\tmake: function() {\n\t\tthis._super();\n\t\tthis.disp_area = this.wrapper;\n\t},\n\trefresh_input: function() {\n\t\tvar content = this.get_content();\n\t\tif(content) this.$wrapper.html(content);\n\t},\n\tget_content: function() {\n\t\tvar content = this.df.options || \"\";\n\t\ttry {\n\t\t\treturn frappe.render(content, this);\n\t\t} catch (e) {\n\t\t\treturn content;\n\t\t}\n\t},\n\thtml: function(html) {\n\t\tthis.$wrapper.html(html || this.get_content());\n\t},\n\tset_value: function(html) {\n\t\tif(html.appendTo) {\n\t\t\t// jquery object\n\t\t\thtml.appendTo(this.$wrapper.empty());\n\t\t} else {\n\t\t\t// html\n\t\t\tthis.df.options = html;\n\t\t\tthis.html(html);\n\t\t}\n\t}\n});\n","frappe.ui.form.ControlHeading = frappe.ui.form.ControlHTML.extend({\n\tget_content: function() {\n\t\treturn \"<h4>\" + __(this.df.label) + \"</h4>\";\n\t}\n});\n","frappe.ui.form.ControlAutocomplete = frappe.ui.form.ControlData.extend({\n\tmake_input() {\n\t\tthis._super();\n\t\tthis.setup_awesomplete();\n\t\tthis.set_options();\n\t},\n\n\tset_options() {\n\t\tif (this.df.options) {\n\t\t\tlet options = this.df.options || [];\n\t\t\tif (typeof options === 'string') {\n\t\t\t\toptions = options.split('\\n');\n\t\t\t}\n\t\t\tif (typeof options[0] === 'string') {\n\t\t\t\toptions = options.map(o => ({label: o, value: o}));\n\t\t\t}\n\t\t\tthis._data = options;\n\t\t}\n\t},\n\n\tget_awesomplete_settings() {\n\t\treturn {\n\t\t\tminChars: 0,\n\t\t\tmaxItems: 99,\n\t\t\tautoFirst: true,\n\t\t\tlist: this.get_data(),\n\t\t\tsort: () => {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t};\n\t},\n\n\tsetup_awesomplete() {\n\t\tthis.awesomplete = new Awesomplete(this.input, this.get_awesomplete_settings());\n\n\t\t$(this.input_area).find('.awesomplete ul').css('min-width', '100%');\n\n\t\tthis.$input.on('input', () => {\n\t\t\tthis.awesomplete.list = this.get_data();\n\t\t});\n\n\t\tthis.$input.on('focus', () => {\n\t\t\tif (!this.$input.val()) {\n\t\t\t\tthis.$input.val('');\n\t\t\t\tthis.$input.trigger('input');\n\t\t\t}\n\t\t});\n\n\t\tthis.$input.on('awesomplete-selectcomplete', () => {\n\t\t\tthis.$input.trigger('change');\n\t\t});\n\t},\n\n\tget_data() {\n\t\treturn this._data || [];\n\t},\n\n\tset_data(data) {\n\t\tif (this.awesomplete) {\n\t\t\tthis.awesomplete.list = data;\n\t\t}\n\t\tthis._data = data;\n\t}\n});\n","frappe.ui.form.ControlBarcode = frappe.ui.form.ControlData.extend({\n\tmake_wrapper() {\n\t\t// Create the elements for barcode area\n\t\tthis._super();\n\n\t\tlet $input_wrapper = this.$wrapper.find('.control-input-wrapper');\n\t\tthis.barcode_area = $(`<div class=\"barcode-wrapper border\"><svg height=80></svg></div>`);\n\t\tfrappe.require(\"assets/frappe/js/lib/JsBarcode.all.min.js\", () => {\n\t\t\tthis.barcode_area.appendTo($input_wrapper);\n\t\t});\n\t},\n\n\tparse(value) {\n\t\t// Parse raw value\n\t\treturn this.get_barcode_html(value);\n\t},\n\n\tset_formatted_input(value) {\n\t\t// Set values to display\n\t\tconst svg = value;\n\t\tconst barcode_value = $(svg).attr('data-barcode-value');\n\n\t\tthis.$input.val(barcode_value);\n\t\tthis.barcode_area.html(svg);\n\t},\n\n\tget_barcode_html(value) {\n\t\t// Get svg\n\t\tconst svg = this.barcode_area.find('svg')[0];\n\t\tJsBarcode(svg, value, this.get_options(value));\n\t\t$(svg).attr('data-barcode-value', value);\n\t\treturn this.barcode_area.html();\n\t},\n\n\tget_options(value) {\n\t\t// get JsBarcode options\n\t\tlet options = JSON.parse('{ \"height\" : 40 }');\n\t\tif (this.isValidJson(this.df.options)) {\n\t\t\toptions = JSON.parse(this.df.options);\n\t\t\tif (options.format && options.format === \"EAN\") {\n\t\t\t\toptions.format = value.length == 8 ? \"EAN8\" : \"EAN13\";\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t},\n\n\tisValidJson(jsonData) {\n\t\ttry {\n\t\t\tJSON.parse(jsonData);\n\t\t\treturn true;\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n});\n","frappe.ui.form.ControlGeolocation = frappe.ui.form.ControlCode.extend({\n\tmake_wrapper() {\n\t\t// Create the elements for map area\n\t\tthis._super();\n\n\t\tlet $input_wrapper = this.$wrapper.find('.control-input-wrapper');\n\t\tthis.map_id = frappe.dom.get_unique_id();\n\t\tthis.map_area = $(\n\t\t\t`<div class=\"map-wrapper border\">\n\t\t\t\t<div id=\"` + this.map_id + `\" style=\"min-height: 400px; z-index: 1; max-width:100%\"></div>\n\t\t\t</div>`\n\t\t);\n\t\tthis.map_area.prependTo($input_wrapper);\n\t\tthis.$wrapper.find('.control-input').addClass(\"hidden\");\n\t\tthis.bind_leaflet_map();\n\t\tthis.bind_leaflet_draw_control();\n\t\tthis.bind_leaflet_locate_control();\n\t\tthis.bind_leaflet_refresh_button();\n\t},\n\n\tformat_for_input(value) {\n\t\t// render raw value from db into map\n\t\tthis.clear_editable_layers();\n\t\tif(value) {\n\t\t\tvar data_layers = new L.FeatureGroup()\n\t\t\t\t.addLayer(L.geoJson(JSON.parse(value),{\n\t\t\t\t\tpointToLayer: function(geoJsonPoint, latlng) {\n\t\t\t\t\t\tif (geoJsonPoint.properties.point_type == \"circle\"){\n\t\t\t\t\t\t\treturn L.circle(latlng, {radius: geoJsonPoint.properties.radius});\n\t\t\t\t\t\t} else if (geoJsonPoint.properties.point_type == \"circlemarker\") {\n\t\t\t\t\t\t\treturn L.circleMarker(latlng, {radius: geoJsonPoint.properties.radius});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn L.marker(latlng);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\tthis.add_non_group_layers(data_layers, this.editableLayers);\n\t\t\ttry {\n\t\t\t\tthis.map.flyToBounds(this.editableLayers.getBounds(), {\n\t\t\t\t\tpadding: [50,50]\n\t\t\t\t});\n\t\t\t}\n\t\t\tcatch(err) {\n\t\t\t\t// suppress error if layer has a point.\n\t\t\t}\n\t\t\tthis.editableLayers.addTo(this.map);\n\t\t\tthis.map._onResize();\n\t\t} else if ((value===undefined) || (value == JSON.stringify(new L.FeatureGroup().toGeoJSON()))) {\n\t\t\tthis.locate_control.start();\n\t\t}\n\t},\n\n\tbind_leaflet_map() {\n\n\t\tvar circleToGeoJSON = L.Circle.prototype.toGeoJSON;\n\t\tL.Circle.include({\n\t\t\ttoGeoJSON: function() {\n\t\t\t\tvar feature = circleToGeoJSON.call(this);\n\t\t\t\tfeature.properties = {\n\t\t\t\t\tpoint_type: 'circle',\n\t\t\t\t\tradius: this.getRadius()\n\t\t\t\t};\n\t\t\t\treturn feature;\n\t\t\t}\n\t\t});\n\n\t\tL.CircleMarker.include({\n\t\t\ttoGeoJSON: function() {\n\t\t\t\tvar feature = circleToGeoJSON.call(this);\n\t\t\t\tfeature.properties = {\n\t\t\t\t\tpoint_type: 'circlemarker',\n\t\t\t\t\tradius: this.getRadius()\n\t\t\t\t};\n\t\t\t\treturn feature;\n\t\t\t}\n\t\t});\n\n\t\tL.Icon.Default.imagePath = '/assets/frappe/images/leaflet/';\n\t\tthis.map = L.map(this.map_id).setView([19.0800, 72.8961], 13);\n\n\t\tL.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {\n\t\t\tattribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n\t\t}).addTo(this.map);\n\t},\n\n\tbind_leaflet_locate_control() {\n\t\t// To request location update and set location, sets current geolocation on load\n\t\tthis.locate_control = L.control.locate({position:'topright'});\n\t\tthis.locate_control.addTo(this.map);\n\t},\n\n\tbind_leaflet_draw_control() {\n\t\tthis.editableLayers = new L.FeatureGroup();\n\n\t\tvar options = {\n\t\t\tposition: 'topleft',\n\t\t\tdraw: {\n\t\t\t\tpolyline: {\n\t\t\t\t\tshapeOptions: {\n\t\t\t\t\t\tcolor: frappe.ui.color.get('blue'),\n\t\t\t\t\t\tweight: 10\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tpolygon: {\n\t\t\t\t\tallowIntersection: false, // Restricts shapes to simple polygons\n\t\t\t\t\tdrawError: {\n\t\t\t\t\t\tcolor: frappe.ui.color.get('orange'), // Color the shape will turn when intersects\n\t\t\t\t\t\tmessage: '<strong>Oh snap!<strong> you can\\'t draw that!' // Message that will show when intersect\n\t\t\t\t\t},\n\t\t\t\t\tshapeOptions: {\n\t\t\t\t\t\tcolor: frappe.ui.color.get('blue')\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcircle: true,\n\t\t\t\trectangle: {\n\t\t\t\t\tshapeOptions: {\n\t\t\t\t\t\tclickable: false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tedit: {\n\t\t\t\tfeatureGroup: this.editableLayers, //REQUIRED!!\n\t\t\t\tremove: true\n\t\t\t}\n\t\t};\n\n\t\t// create control and add to map\n\t\tvar drawControl = new L.Control.Draw(options);\n\n\t\tthis.map.addControl(drawControl);\n\n\t\tthis.map.on('draw:created', (e) => {\n\t\t\tvar type = e.layerType,\n\t\t\t\tlayer = e.layer;\n\t\t\tif (type === 'marker') {\n\t\t\t\tlayer.bindPopup('Marker');\n\t\t\t}\n\t\t\tthis.editableLayers.addLayer(layer);\n\t\t\tthis.set_value(JSON.stringify(this.editableLayers.toGeoJSON()));\n\t\t});\n\n\t\tthis.map.on('draw:deleted draw:edited', (e) => {\n\t\t\tvar layer = e.layer;\n\t\t\tthis.editableLayers.removeLayer(layer);\n\t\t\tthis.set_value(JSON.stringify(this.editableLayers.toGeoJSON()));\n\t\t});\n\t},\n\n\tbind_leaflet_refresh_button() {\n\t\tL.easyButton({\n\t\t\tid: 'refresh-map-'+this.df.fieldname,\n\t\t\tposition: 'topright',\n\t\t\ttype: 'replace',\n\t\t\tleafletClasses: true,\n\t\t\tstates:[{\n\t\t\t\tstateName: 'refresh-map',\n\t\t\t\tonClick: function(button, map){\n\t\t\t\t\tmap._onResize();\n\t\t\t\t},\n\t\t\t\ttitle: 'Refresh map',\n\t\t\t\ticon: 'fa fa-refresh'\n\t\t\t}]\n\t\t}).addTo(this.map);\n\t},\n\n\tadd_non_group_layers(source_layer, target_group) {\n\t\t// https://gis.stackexchange.com/a/203773\n\t\t// Would benefit from https://github.com/Leaflet/Leaflet/issues/4461\n\t\tif (source_layer instanceof L.LayerGroup) {\n\t\t\tsource_layer.eachLayer((layer)=>{\n\t\t\t\tthis.add_non_group_layers(layer, target_group);\n\t\t\t});\n\t\t} else {\n\t\t\ttarget_group.addLayer(source_layer);\n\t\t}\n\t},\n\n\tclear_editable_layers() {\n\t\tthis.editableLayers.eachLayer((l)=>{\n\t\t\tthis.editableLayers.removeLayer(l);\n\t\t});\n\t}\n});\n","frappe.ui.form.ControlMultiSelect = frappe.ui.form.ControlAutocomplete.extend({\n\tget_awesomplete_settings() {\n\t\tconst settings = this._super();\n\n\t\treturn Object.assign(settings, {\n\t\t\tfilter: function(text, input) {\n\t\t\t\treturn Awesomplete.FILTER_CONTAINS(text, input.match(/[^,]*$/)[0]);\n\t\t\t},\n\n\t\t\titem: function(text, input) {\n\t\t\t\treturn Awesomplete.ITEM(text, input.match(/[^,]*$/)[0]);\n\t\t\t},\n\n\t\t\treplace: function(text) {\n\t\t\t\tconst before = this.input.value.match(/^.+,\\s*|/)[0];\n\t\t\t\tthis.input.value = before + text + \", \";\n\t\t\t}\n\t\t});\n\t},\n\n\tget_values() {\n\t\tconst value = this.get_value() || '';\n\t\tconst values = value.split(', ').filter(d => d);\n\n\t\treturn values;\n\t},\n\n\tget_data() {\n\t\tconst values = this.get_values();\n\t\tconst data = this._super();\n\n\t\t// return values which are not already selected\n\t\treturn data.filter(d => !values.includes(d));\n\t}\n});\n","frappe.ui.form.ControlMultiCheck = frappe.ui.form.Control.extend({\n\t// UI: multiple checkboxes\n\t// Value: Array of values\n\t// Options: Array of label/value/checked option objects\n\n\tmake() {\n\t\tthis._super();\n\t\tthis.$label = $(`<label class=\"control-label\">${this.df.label || ''}</label>`).appendTo(this.wrapper);\n\t\tthis.$load_state = $('<div class=\"load-state text-muted small\">' + __(\"Loading\") + '...</div>');\n\t\tthis.$select_buttons = this.get_select_buttons().appendTo(this.wrapper);\n\t\tthis.$load_state.appendTo(this.wrapper);\n\n\t\tconst row = this.get_column_size() === 12 ? '' : 'row';\n\t\tthis.$checkbox_area = $(`<div class=\"checkbox-options ${row}\"></div>`).appendTo(this.wrapper);\n\t\tthis.refresh();\n\t},\n\n\trefresh() {\n\t\tthis.set_options();\n\t\tthis.bind_checkboxes();\n\t\tthis.refresh_input();\n\t},\n\n\trefresh_input() {\n\t\tthis.select_options(this.selected_options);\n\t},\n\n\tset_options() {\n\t\tthis.$load_state.show();\n\t\tthis.$select_buttons.hide();\n\t\tthis.parse_df_options();\n\n\t\tif(this.df.get_data) {\n\t\t\tif(typeof this.df.get_data().then == 'function') {\n\t\t\t\tthis.df.get_data().then(results => {\n\t\t\t\t\tthis.options = results;\n\t\t\t\t\tthis.make_checkboxes();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.options = this.df.get_data();\n\t\t\t\tthis.make_checkboxes();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.make_checkboxes();\n\t\t}\n\t},\n\n\tparse_df_options() {\n\t\tif(Array.isArray(this.df.options)) {\n\t\t\tthis.options = this.df.options;\n\t\t} else if(this.df.options && this.df.options.length>0 && frappe.utils.is_json(this.df.options)) {\n\t\t\tlet args = JSON.parse(this.df.options);\n\t\t\tif(Array.isArray(args)) {\n\t\t\t\tthis.options = args;\n\t\t\t} else if(Array.isArray(args.options)) {\n\t\t\t\tthis.options = args.options;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.options = [];\n\t\t}\n\t},\n\n\tmake_checkboxes() {\n\t\tthis.$load_state.hide();\n\t\tthis.$checkbox_area.empty();\n\t\tthis.options.forEach(option => {\n\t\t\tthis.get_checkbox_element(option).appendTo(this.$checkbox_area);\n\t\t});\n\t\tif(this.df.select_all) {\n\t\t\tthis.setup_select_all();\n\t\t}\n\t\tthis.set_checked_options();\n\t},\n\n\tbind_checkboxes() {\n\t\t$(this.wrapper).on('change', ':checkbox', e => {\n\t\t\tconst $checkbox = $(e.target);\n\t\t\tconst option_name = $checkbox.attr(\"data-unit\");\n\t\t\tif($checkbox.is(':checked')) {\n\t\t\t\tthis.selected_options.push(option_name);\n\t\t\t} else {\n\t\t\t\tlet index = this.selected_options.indexOf(option_name);\n\t\t\t\tthis.selected_options.splice(index, 1);\n\t\t\t}\n\t\t\tthis.df.on_change && this.df.on_change();\n\t\t});\n\t},\n\n\tset_checked_options() {\n\t\tthis.selected_options = this.options\n\t\t\t.filter(o => o.checked)\n\t\t\t.map(o => o.value);\n\t\tthis.select_options(this.selected_options);\n\t},\n\n\tsetup_select_all() {\n\t\tthis.$select_buttons.show();\n\t\tlet select_all = (deselect=false) => {\n\t\t\t$(this.wrapper).find(`:checkbox`).prop(\"checked\", deselect).trigger('click');\n\t\t};\n\t\tthis.$select_buttons.find('.select-all').on('click', () => {\n\t\t\tselect_all();\n\t\t});\n\t\tthis.$select_buttons.find('.deselect-all').on('click', () => {\n\t\t\tselect_all(true);\n\t\t});\n\t},\n\n\tselect_options(selected_options) {\n\t\tthis.options.map(option => option.value).forEach(value => {\n\t\t\tlet $checkbox = $(this.wrapper).find(`:checkbox[data-unit=\"${value}\"]`)[0];\n\t\t\tif($checkbox) $checkbox.checked = selected_options.includes(value);\n\t\t});\n\t},\n\n\tget_value() {\n\t\treturn this.selected_options;\n\t},\n\n\tget_checked_options() {\n\t\treturn this.get_value();\n\t},\n\n\tget_unchecked_options() {\n\t\treturn this.options.map(o => o.value)\n\t\t\t.filter(value => !this.selected_options.includes(value));\n\t},\n\n\tget_checkbox_element(option) {\n\t\tconst column_size = this.get_column_size();\n\t\treturn $(`\n\t\t\t<div class=\"checkbox unit-checkbox col-sm-${column_size}\">\n\t\t\t\t<label>\n\t\t\t\t<input type=\"checkbox\" data-unit=\"${option.value}\">\n\t\t\t\t</input>\n\t\t\t\t<span class=\"label-area small\" data-unit=\"${option.value}\">${__(option.label)}</span>\n\t\t\t\t</label>\n\t\t\t</div>`);\n\t},\n\n\tget_select_buttons() {\n\t\treturn $(`<div><button class=\"btn btn-xs btn-default select-all\">\n\t\t\t${__(\"Select All\")}</button>\n\t\t\t<button class=\"btn btn-xs btn-default deselect-all\">\n\t\t${__(\"Unselect All\")}</button></div>`);\n\t},\n\n\tget_column_size() {\n\t\treturn 12 / (+this.df.columns || 1);\n\t}\n});\n"],"names":["frappe","_","get_data_uri","element","const","$element","$","width","height","$canvas","getContext","drawImage","toDataURL","ui","Capture","options","this","OPTIONS","set_options","Object","render","navigator","mediaDevices","getUserMedia","video","then","stream","dialog","Dialog","title","animate","action","secondary","label","$e","TEMPLATE","find","srcObject","play","body","html","hide","click","data_url","attr","show","callback","catch","err","error","alert","show_alert","submit","fn","__","ERR_MESSAGE","form","make_control","opts","control_class_name","df","fieldtype","replace","console","log","Control","Class","extend","init","make","boot","user","name","developer_mode","$wrapper","fieldname","render_input","refresh","make_wrapper","wrapper","get","fieldobj","appendTo","parent","toggle","hidden","get_status","explain","doctype","docname","cint","hidden_due_to_dependency","read_only","status","perm","get_field_display_status","model","get_doc","frm","only_input","is_null","get_value","in_list","disp_status","toggleClass","refresh_input","value","show_translatable_button","can_write","doc","translatable","views","TranslationManager","length","translation_btn","on","__islocal","source_name","target_language","language","locals","get_model_value","set_value","validate_and_set_in_model","parse_validate_and_set_in_model","e","parse","me","inside_change_event","Promise","resolve","set","run_serially","set_model_value","set_mandatory","change","onchange","apply","validate","get_input_value","undefined","last_value","set_input","set_focus","$input","focus","ControlInput","horizontal","_super","set_input_areas","set_max_width","toggle_label","toggle_description","input_area","label_area","label_span","$input_wrapper","disp_area","addClass","make_input","has_input","on_make","update_input","prop","set_disp_area","set_description","set_label","set_bold","format","no_icon","inline","bind_change_event","bind_focusout","dom","is_touchscreen","utils","scroll_to","_label","innerHTML","description","_description","set_empty_description","set_new_description","reqd","bold","ControlData","html_element","input_type","prependTo","set_input_attributes","input","setup_autoname_check","meta","get_meta","autoname","substr","let","timeout","setTimeout","last_check","clearTimeout","db","val","placeholder","input_css","css","input_class","set_formatted_input","format_for_input","v","v1","email_list","split_emails","invalid_email","forEach","email","validate_email","msgprint","ControlInt","document","activeElement","select","ControlFloat","isNaN","parseFloat","flt","get_precision","number_format","trim","get_number_format","formatted_value","format_number","currency","get_field_currency","precision","sysdefaults","float_precision","ControlPercent","ControlCurrency","currency_precision","get_number_format_info","ControlDate","set_date_options","set_datepicker","set_t_for_today","should_refresh","datepicker","selectedDates","moment","date_format","selectDate","datetime","str_to_obj","lang","today_text","defaultDateFormat","datepicker_options","autoClose","todayButton","dateFormat","startDate","now_date","keyboardNav","onSelect","trigger","onShow","$datepicker","text","update_datepicker_position","position","window","scrollTop","offset","top","update","data","get_now_date","which","nowdate","now_datetime","now_time","user_to_str","str_to_user","sys_defaults","ControlTime","timepicker","onlyTimepicker","timeFormat","date_obj","moment_to_date_obj","is_timezone_same","includes","time_zone","ControlDatetime","defaultDatetimeFormat","ControlDateRange","range","toggleSelected","value2","formatted","to","vals","split","user_to_obj","value1","ControlSelect","input_value","toString","last_options","selected","empty","add_options","get_file_attachment_list","fl","docinfo","attachments","each","i","f","push","file_url","ControlLink","$input_area","$link","$link_open","get_options","translate_values","setup_buttons","setup_awesomeplete","with_link_btn","remove","open_advanced_search","LinkSelector","target","txt","new_doc","get_route_options_for_new_doc","route_options","name_field","_from_link","_from_link_scrollY","make_quick_entry","cache","awesomplete","Awesomplete","minChars","maxItems","autoFirst","list","item","filter","d","get_item","sort","debounce","term","args","set_custom_query","call","type","method","no_spinner","r","is","only_select","can_create","results","z-index","autocomplete_open","o","originalEvent","keyCode","preventDefault","close","remember_last_selected_value","last_selected_values","indexOf","set_nulls","obj","key","get_query","isPlainObject","filters","query","q","ignore_link_validation","validate_link_and_fetch","fetch","fetch_dict","columns","join","message","fetch_values","set_fetch_values","valid_value","fields","prototype","_list","ControlDynamicLink","cur_dialog","cur_frm","selector","cur_list","cur_page","page","is_single","throw","ControlText","ControlLongText","ControlSmallText","ControlCode","allowTabs","ControlTextEditor","make_editor","hide_elements_on_mobile","setup_drag_drop","setup_image_dialog","setting_count","last_keystroke_on","render_camera_button","context","summernote","button","contents","tooltip","capture","invoke","editor","minHeight","toolbar","buttons","camera","keyMap","pc","CTRL+ENTER","mac","CMD+ENTER","prettifyHtml","dialogsInBody","callbacks","onInit","one","$this","onChange","onKeydown","Date","keys","get_key","stopPropagation","note_editor","hasClass","icons","align","alignCenter","alignJustify","alignLeft","alignRight","indent","outdent","arrowsAlt","caret","circle","code","eraser","font","frame","italic","link","unlink","magic","menuCheck","minus","orderedlist","pencil","picture","question","redo","square","strikethrough","subscript","superscript","table","textHeight","trash","underline","undo","unorderedlist","dataTransfer","files","slice","file","get_image","url","fileobj","reader","FileReader","onload","dataurl","result","parts","readAsDataURL","remove_script_and_style","set_in_editor","time_since_last_keystroke","_setting_value","setInterval","clearInterval","set_upload_options","upload_options","image_dialog","get_field","max_width","max_height","no_socketio","btn","set_primary_action","on_no_attach","attachment","file_name","onerror","is_private","from_form","on_attach","hide_progress","get_attachments","map","concat","upload","ControlCheck","removeClass","checked","ControlImage","margin","$body","margin-bottom","$img","$buffer","ControlAttach","onclick","$value","clear_attachment","remove_attachment_by_filename","docstatus","save","parenttype","allow_multiple","on_upload_complete","filename","update_attachment","ControlAttachImage","container","insertAfter","detach","append","img_wrapper","img_container","img","img_overlay","remove_image_link","set_image","ControlTable","grid","Grid","grids","get_data","ControlColor","colors","make_color_input","$color_pallete","color_html","get_color_box","bind_events","hex","contrast","color","get_contrast_color","background-color","mousedown_happened","color_val","mousedown","test","ControlSignature","saving","loading","make_pad","$pad","jSignature","lineWidth","on_save_sign","bind","load_pad","$reset_button_wrapper","on_reset_sign","set_editable","editable","set_my_value","base64_img","ControlPassword","indicator","check_password_timeout","get_password_strength","new_password","entropy","score","feedback","crack_time_display","set_strength_indicator","ControlReadOnly","ControlButton","script_manager","has_handlers","runscript","icon","ControlHTML","content","get_content","ControlHeading","ControlAutocomplete","setup_awesomplete","_data","get_awesomplete_settings","set_data","ControlBarcode","barcode_area","require","get_barcode_html","svg","barcode_value","JsBarcode","JSON","isValidJson","jsonData","ControlGeolocation","map_id","get_unique_id","map_area","bind_leaflet_map","bind_leaflet_draw_control","bind_leaflet_locate_control","bind_leaflet_refresh_button","clear_editable_layers","data_layers","L","FeatureGroup","addLayer","geoJson","pointToLayer","geoJsonPoint","latlng","properties","point_type","radius","circleMarker","marker","add_non_group_layers","editableLayers","flyToBounds","getBounds","padding","addTo","_onResize","stringify","toGeoJSON","locate_control","start","circleToGeoJSON","Circle","include","feature","getRadius","CircleMarker","Icon","Default","imagePath","setView","tileLayer","attribution","control","locate","draw","polyline","shapeOptions","weight","polygon","allowIntersection","drawError","rectangle","clickable","edit","featureGroup","drawControl","Draw","addControl","layerType","layer","bindPopup","removeLayer","easyButton","id","leafletClasses","states","stateName","onClick","source_layer","target_group","LayerGroup","eachLayer","l","ControlMultiSelect","settings","assign","FILTER_CONTAINS","match","ITEM","before","get_values","values","ControlMultiCheck","$label","$load_state","$select_buttons","get_select_buttons","row","get_column_size","$checkbox_area","bind_checkboxes","select_options","selected_options","parse_df_options","make_checkboxes","Array","isArray","is_json","option","get_checkbox_element","select_all","setup_select_all","set_checked_options","$checkbox","option_name","index","splice","on_change","deselect","get_checked_options","get_unchecked_options","column_size"],"mappings":"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"}